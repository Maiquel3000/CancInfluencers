<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- T√≠tulo Cambiado a CANCINFLUENCERS -->
    <title>CancInfluencers</title>
    <!-- Favicon A√±adido -->
    <link rel="icon" type="image/x-icon" href="https://i.imgur.com/qQ7aGbv.png">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            /* Flexbox para centrar el logo y el t√≠tulo verticalmente */
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        /* Estilo para el logo a√±adido */
        .header-logo {
            max-height: 60px;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 10px rgba(168, 85, 247, 0.5));
            transition: transform 0.3s ease;
        }

        .header-logo:hover {
            transform: scale(1.1);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(to right, #a855f7, #ec4899);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            color: #d1d5db;
            margin-bottom: 20px;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .search-input {
            padding: 10px 15px;
            border-radius: 8px;
            border: none;
            background-color: #374151;
            color: white;
            width: 250px;
            font-size: 16px;
        }

        .search-input:focus {
            outline: none;
            box-shadow: 0 0 0 2px #a855f7;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .shuffle-btn {
            background: linear-gradient(to right, #a855f7, #ec4899);
            color: white;
        }

        .shuffle-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(168, 85, 247, 0.4);
        }

        .add-btn {
            background: linear-gradient(to right, #10b981, #059669);
            color: white;
        }

        .add-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .tierlist-btn {
            background: linear-gradient(to right, #f59e0b, #d97706);
            color: white;
        }

        .tierlist-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);
        }

        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }

        .card-container {
            position: relative;
            width: 100%;
            height: 300px;
            perspective: 1000px;
        }

        .card {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.7s;
            cursor: pointer;
        }

        .card.flipped {
            transform: rotateY(180deg);
        }

        .card.animating {
            animation: flipToCenter 0.8s ease-in-out forwards;
        }

        @keyframes flipToCenter {
            0% {
                transform: rotateY(0deg) scale(1);
            }
            50% {
                transform: rotateY(90deg) scale(1.1);
            }
            100% {
                transform: rotateY(180deg) scale(1);
            }
        }

        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .card-front {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
        }

        .card-front:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b46a1 100%);
        }

        .music-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .card-front-text {
            color: white;
            font-size: 1.2rem;
            font-weight: bold;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);
        }

        .card-front-subtext {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9rem;
            margin-top: 10px;
        }

        .card-back {
            background-color: #1f2937;
            transform: rotateY(180deg);
            display: flex;
            flex-direction: column;
        }

        .influencer-header {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            padding: 10px;
            text-align: center;
        }

        .influencer-name {
            font-weight: bold;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .video-container {
            flex-grow: 1;
            position: relative;
            background-color: black;
        }

        .video-thumbnail {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .play-button {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background-color: rgba(255, 255, 255, 0.8);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 10;
        }

        .play-button::after {
            content: "‚ñ∂";
            font-size: 20px;
            color: #333;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            position: relative;
            width: 100%;
            max-width: 900px;
            height: 600px;
            background-color: #1f2937;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            transform: scale(0.9);
            transition: transform 0.3s ease-in-out;
        }

        .modal.active .modal-content {
            transform: scale(1);
        }

        .modal-header {
            background: linear-gradient(to right, #3b82f6, #8b5cf6);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-weight: bold;
            font-size: 1.2rem;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
            z-index: 10;
        }

        .close-btn:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            display: flex;
            flex-direction: column;
            height: calc(100% - 60px);
        }

        .modal-video {
            flex-grow: 1;
            background-color: black;
            position: relative;
        }

        .modal-video iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

                /* Estilo para el modal de video cuando est√° sobre la tierlist */
        .modal.on-top-of-tierlist {
            z-index: 1001; /* Un nivel por encima del modal de la tierlist */
            background-color: rgba(0, 0, 0, 0.4); /* Fondo m√°s transparente para ver la tierlist */
        }

        /* Asegura que el contenido del modal siga siendo opaco y legible */
        .modal.on-top-of-tierlist .modal-content {
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7); /* Sombra m√°s fuerte para resaltar */
        }

        .tier-selection-panel {
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tier-selection-title {
            font-size: 0.9rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
            color: #d1d5db;
        }

        .tier-options {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .tier-option {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
            color: white;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .tier-option:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .tier-option.selected {
            transform: scale(1.05);
            box-shadow: 0 0 0 3px white;
        }

        .tier-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .tier-option.disabled:hover {
            transform: none;
            box-shadow: none;
        }

        .tier-s { background-color: #ff7f7f; }
        .tier-a { background-color: #ffbf7f; }
        .tier-b { background-color: #ffff7f; }
        .tier-c { background-color: #7fff7f; }
        .tier-d { background-color: #7fffff; }
        .tier-f { background-color: #7f7fff; }

        .tier-selection-status {
            text-align: center;
            font-size: 0.8rem;
            color: #9ca3af;
        }

        .tier-selection-status.success {
            color: #10b981;
        }

        /* Modal para a√±adir influencer */
        .add-modal-content {
            width: 100%;
            max-width: 500px;
            background-color: #1f2937;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .add-modal-header {
            margin-bottom: 25px;
            text-align: center;
        }

        .add-modal-title {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(to right, #10b981, #059669);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #d1d5db;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid #374151;
            background-color: #374151;
            color: white;
            font-size: 16px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .form-input:focus {
            outline: none;
            border-color: #10b981;
            box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
        }

        .form-input::placeholder {
            color: #9ca3af;
        }

        .form-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .form-btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn {
            background: linear-gradient(to right, #10b981, #059669);
            color: white;
        }

        .submit-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);
        }

        .cancel-btn {
            background-color: #374151;
            color: white;
        }

        .cancel-btn:hover {
            background-color: #4b5563;
            transform: scale(1.02);
        }

        .error-message {
            color: #ef4444;
            font-size: 0.9rem;
            margin-top: 5px;
            display: none;
        }

        .success-message {
            background-color: rgba(16, 185, 129, 0.2);
            border: 1px solid #10b981;
            color: #10b981;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            display: none;
        }

        .no-results {
            text-align: center;
            padding: 40px;
            color: #9ca3af;
        }

        /* Toggle para canciones de fans */
        .fans-toggle-container {
            margin: 40px 0;
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.1), rgba(236, 72, 153, 0.1));
            border-radius: 16px;
            border: 1px solid rgba(168, 85, 247, 0.3);
        }

        .fans-toggle {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .fans-label {
            font-size: 1.2rem;
            font-weight: bold;
            color: #d1d5db;
        }

        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background-color: #374151;
            border-radius: 15px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .toggle-switch.active {
            background: linear-gradient(to right, #a855f7, #ec4899);
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background-color: white;
            border-radius: 50%;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(30px);
        }

        .fans-count {
            font-size: 0.9rem;
            color: #9ca3af;
            margin-top: 10px;
        }

        .fans-section {
            margin-top: 20px;
            opacity: 0;
            max-height: 0;
            overflow: hidden;
            transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out;
        }

        .fans-section.active {
            opacity: 1;
            max-height: 2000px;
        }

        .fans-title {
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            background: linear-gradient(to right, #f59e0b, #f97316);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            color: #9ca3af;
            font-size: 0.9rem;
            padding: 20px 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .creator-info {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
            color: #d1d5db;
        }

        .creator-name {
            font-weight: bold;
            color: #a855f7;
        }

        .social-links {
            display: flex;
            gap: 15px;
        }

        .social-link {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #e1306c, #c13584);
            border-radius: 50%;
            color: white;
            text-decoration: none;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .social-link:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .social-link svg {
            width: 20px;
            height: 20px;
            fill: currentColor;
        }

        .card.revealed .card-front {
            opacity: 0.7;
        }
        
        .card.revealed .music-icon {
            animation: none;
        }

/* Modal para ver tierlist */
.tierlist-modal-content {
    width: 95%;
    max-width: 1200px;
    height: 95vh; /* Ocupa casi toda la altura de la ventana */
    background-color: #1f2937;
    border-radius: 16px;
    padding: 20px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    display: flex; /* Activa Flexbox para el contenido del modal */
    flex-direction: column; /* Alinea los elementos en columna */
    overflow: hidden; /* Evita que cualquier hijo se salga del modal */
    position: relative;
}

.tierlist-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    flex-shrink: 0; /* Evita que el encabezado se encoja */
}

.tierlist-title {
    font-size: 1.5rem;
    font-weight: bold;
    background: linear-gradient(to right, #f59e0b, #d97706);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.tierlist-actions {
    display: flex;
    gap: 10px;
}

.edit-tiers-btn {
    background: linear-gradient(to right, #8b5cf6, #6366f1);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 8px 16px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.9rem;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: transform 0.2s, box-shadow 0.2s;
}

.edit-tiers-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
}

.tier-stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 15px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
    flex-shrink: 0; /* Evita que las estad√≠sticas se encojan */
}

.tier-stat {
    text-align: center;
}

.tier-stat-number {
    font-size: 1.2rem;
    font-weight: bold;
    color: #f59e0b;
}

.tier-stat-label {
    font-size: 0.8rem;
    color: #d1d5db;
}

.reorder-hint {
    text-align: center;
    color: #9ca3af;
    font-size: 0.8rem;
    margin-bottom: 10px;
    font-style: italic;
    flex-shrink: 0; /* Evita que la pista se encoja */
}

/* ESTE ES EL CONTENEDOR CLAVE */
.tierlist-container {
    flex-grow: 1; /* ¬°CLAVE! Ocupa todo el espacio vertical restante */
    display: flex;
    flex-direction: column;
    overflow-y: auto; /* ¬°CLAVE! Reactiva el scroll vertical */
    padding-right: 10px; /* Espacio para la barra de scroll */
    min-height: 0; /* ¬°CLAVE! Permite que los hijos flexibles se encojan por debajo de su tama√±o de contenido */
}

/* ESTILOS PARA LA BARRA DE SCROLL */
.tierlist-container::-webkit-scrollbar {
    width: 8px;
}

.tierlist-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.tierlist-container::-webkit-scrollbar-thumb {
    background: linear-gradient(to right, #f59e0b, #d97706);
    border-radius: 4px;
}

.tierlist-container::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to right, #d97706, #b45309);
}

/* CADA FILA DE TIER SE ADJUSTAR√Å */
.tier-row {
    display: flex;
    /* ¬°CLAVE! Todas las filas crecer√°n por igual para llenar el espacio disponible */
    flex-grow: 1;
    flex-shrink: 1; /* Permite que las filas se encojan si es necesario */
    margin-bottom: 5px;
    border-radius: 8px;
    overflow: hidden;
    position: relative;
    min-height: 60px; /* Altura m√≠nima para que no sean demasiado peque√±as */
}

.tier-row.drag-over {
    background-color: rgba(255, 255, 255, 0.1);
}

.tier-label {
    width: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1rem;
    color: white;
    flex-shrink: 0; /* La etiqueta no cambia de tama√±o */
}

.tier-s { background-color: #ff7f7f; }
.tier-a { background-color: #ffbf7f; }
.tier-b { background-color: #ffff7f; }
.tier-c { background-color: #7fff7f; }
.tier-d { background-color: #7fffff; }
.tier-f { background-color: #7f7fff; }
.tier-unclassified { background-color: #6b7280; }

/* EL CONTENEDOR DE ITEMS SE AJUSTA A LA ALTURA DE SU FILA */
.tier-items {
    flex-grow: 1; /* Ocupa el ancho restante de la fila */
    background-color: rgba(255, 255, 255, 0.1);
    display: flex;
    flex-wrap: wrap;
    align-items: center; /* Centra los items verticalmente */
    padding: 5px;
    gap: 5px;
    overflow: auto; /* Permite scroll si hay muchos items en una fila */
}

/* Estilo espec√≠fico para la etiqueta "Sin Clasificar" */
.tier-row .tier-label {
    width: 7%; /* Ancho porcentual como solicitaste */
    height: auto; /* Permite que la altura sea autom√°tica */
    min-height: 80px; /* Altura m√≠nima para que no sea demasiado peque√±a */
    
    /* --- FUENTE DIN√ÅMICA (LA CLAVE PARA QUE NO SE ESCAPE) --- */
    font-size: clamp(0.6rem, 1.5vw, 0.9rem); /* Ajusta el tama√±o de letra seg√∫n el espacio */
    line-height: 1.2; /* Espaciado entre l√≠neas ajustado */
    
    text-align: center; /* Centra el texto horizontalmente */
    white-space: normal; /* Permite que el texto se divida en l√≠neas */
    overflow-wrap: break-word; /* Rompe palabras largas si es necesario */
    word-break: break-word; /* Asegura el corte en navegadores antiguos */
    padding: 5px; /* Un peque√±o padding para que no toque los bordes */
    
    /* Usamos Flexbox para centrar perfectamente el contenido */
    display: flex;
    flex-direction: column;
    justify-content: center; /* Centra verticalmente el bloque de texto */
    align-items: center; /* Centra horizontalmente el bloque de texto */
    flex-shrink: 0; /* Evita que la etiqueta se encoja */
}

/* ESTILOS PARA EL SCROLL DENTRO DE CADA FILA */
.tier-items::-webkit-scrollbar {
    height: 6px;
}

.tier-items::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 3px;
}

.tier-items::-webkit-scrollbar-thumb {
    background: rgba(255, 255, 255, 0.3);
    border-radius: 3px;
}

.tier-item {
    background-color: #374151;
    border-radius: 6px;
    padding: 4px 8px;
    display: flex;
    align-items: center;
    gap: 6px;
    max-width: 180px;
    transition: transform 0.2s, box-shadow 0.2s;
    cursor: move;
    position: relative;
    height: 45px;
    flex-shrink: 0; /* Evita que los items se encojan */
    cursor: default; /* Cambia el cursor a una mano para indicar que es clicable */
    transition: transform 0.2s, box-shadow 0.2s, border 0.2s; /* A√±adimos 'border' a la transici√≥n */
    border: 1px solid transparent; /* Borde transparente por defecto */
}

.tier-item:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.4); /* A√±ade un borde sutil al pasar el rat√≥n */
}

.tier-item.dragging {
    opacity: 0.5;
    transform: rotate(5deg);
}

.tier-item-thumbnail {
    width: 30px;
    height: 30px;
    border-radius: 4px;
    object-fit: cover;
}

.tier-item-name {
    font-size: 0.8rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.tier-item-remove {
    position: absolute;
    top: -5px;
    right: -5px;
    width: 18px;
    height: 18px;
    background-color: #ef4444;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    font-size: 11px;
    color: white;
    opacity: 0;
    transition: opacity 0.2s;
}

.tier-item:hover .tier-item-remove {
    opacity: 1;
}

.empty-tierlist {
    text-align: center;
    padding: 40px;
    color: #9ca3af;
}

.empty-tierlist-icon {
    font-size: 3rem;
    margin-bottom: 15px;
}

        /* Modal para editar tiers */
        .edit-tiers-modal-content {
            width: 100%;
            max-width: 600px;
            background-color: #1f2937;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }

        .edit-tiers-header {
            margin-bottom: 25px;
            text-align: center;
        }

        .edit-tiers-title {
            font-size: 1.5rem;
            font-weight: bold;
            background: linear-gradient(to right, #8b5cf6, #6366f1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .edit-tiers-subtitle {
            color: #9ca3af;
            margin-top: 5px;
            font-size: 0.9rem;
        }

        .tier-edit-group {
            margin-bottom: 20px;
        }

        .tier-edit-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            font-weight: 500;
            color: #d1d5db;
        }

        .tier-color-preview {
            width: 24px;
            height: 24px;
            border-radius: 4px;
        }

        .tier-edit-input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #374151;
            background-color: #374151;
            color: white;
            font-size: 16px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .tier-edit-input:focus {
            outline: none;
            border-color: #8b5cf6;
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
        }

        .edit-tiers-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
        }

        .reset-tiers-btn {
            background-color: #374151;
            color: white;
        }

        .reset-tiers-btn:hover {
            background-color: #4b5563;
            transform: scale(1.02);
        }

        .save-tiers-btn {
            background: linear-gradient(to right, #8b5cf6, #6366f1);
            color: white;
        }

        .save-tiers-btn:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);
        }
        
        /* Estilos para el bot√≥n de categor√≠as */
.categories-btn {
    background: linear-gradient(to right, #06b6d4, #0891b2);
    color: white;
}

.categories-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
}

/* Estilos para el filtro activo */
.active-category {
    background-color: rgba(6, 182, 212, 0.2);
    border: 1px solid #06b6d4;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.active-category-name {
    font-weight: bold;
    color: #06b6d4;
    font-size: 1.1rem;
}

.clear-filter-btn {
    background: none;
    border: 1px solid #06b6d4;
    color: #06b6d4;
    border-radius: 6px;
    padding: 6px 12px;
    cursor: pointer;
    font-weight: bold;
    font-size: 0.9rem;
    transition: background-color 0.2s, color 0.2s;
}

.clear-filter-btn:hover {
    background-color: #06b6d4;
    color: white;
}

/* Estilos para el modal de categor√≠as */
.categories-modal-content {
    width: 95%;
    max-width: 900px;
    height: 80vh;
    background-color: #1f2937;
    border-radius: 16px;
    padding: 30px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    position: relative;
}

.categories-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.categories-title {
    font-size: 1.8rem;
    font-weight: bold;
    background: linear-gradient(to right, #06b6d4, #0891b2);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.categories-container {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    gap: 15px;
    overflow-y: auto;
    padding-right: 10px;
}

.categories-container::-webkit-scrollbar {
    width: 8px;
}

.categories-container::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
}

.categories-container::-webkit-scrollbar-thumb {
    background: linear-gradient(to right, #06b6d4, #0891b2);
    border-radius: 4px;
}

.categories-container::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(to right, #0891b2, #0e7490);
}

.category-header-btn {
    width: 100%;
    padding: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: linear-gradient(to right, #374151, #4b5563);
    color: white;
    font-weight: bold;
    font-size: 1.2rem;
    cursor: pointer;
    border: none;
    border-radius: 12px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.category-header-btn:hover {
    background: linear-gradient(to right, #4b5563, #6b7280);
    transform: scale(1.02);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
}

.category-header-btn:active {
    transform: scale(0.98);
}

.category-header-btn.selected {
    background: linear-gradient(to right, #06b6d4, #0891b2);
    box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.5);
}

.category-header-btn.selected:hover {
    background: linear-gradient(to right, #0891b2, #0e7490);
    box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.7);
}

.category-header-btn.all-btn {
    background: linear-gradient(to right, #10b981, #059669);
}

.category-header-btn.all-btn.selected {
    background: linear-gradient(to right, #059669, #047857);
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.5);
}

.category-header-btn.all-btn:hover {
    background: linear-gradient(to right, #059669, #047857);
    box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
}

.category-header-btn.all-btn.selected:hover {
    box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.7);
}

.category-header-btn::before {
    content: '';
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.5s;
}

.category-header-btn:hover::before {
    left: 100%;
}

.category-actions {
    display: flex;
    gap: 10px;
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.apply-filters-btn {
    flex: 1;
    padding: 12px 20px;
    background: linear-gradient(to right, #06b6d4, #0891b2);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.2s;
}

.apply-filters-btn:hover {
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(6, 182, 212, 0.4);
}

.clear-all-btn {
    padding: 12px 20px;
    background-color: #374151;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: background-color 0.2s, transform 0.2s;
}

.clear-all-btn:hover {
    background-color: #4b5563;
    transform: scale(1.02);
}

.category-stats {
    display: flex;
    justify-content: space-around;
    margin-bottom: 20px;
    padding: 15px;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 8px;
}

.category-stat {
    text-align: center;
}

.category-stat-number {
    font-size: 1.5rem;
    font-weight: bold;
    color: #06b6d4;
}

.category-stat-label {
    font-size: 0.9rem;
    color: #d1d5db;
}

.filter-info {
    text-align: center;
    color: #9ca3af;
    font-size: 0.9rem;
    margin-top: 10px;
    font-style: italic;
}

.selected-count {
    background-color: rgba(6, 182, 212, 0.2);
    border: 1px solid #06b6d4;
    border-radius: 8px;
    padding: 10px;
    margin-bottom: 15px;
    text-align: center;
    font-weight: bold;
    color: #06b6d4;
}

/* ESTILOS PARA LAS NOTIFICACIONES (ACTUALIZADOS) */
.notification {
    position: fixed;
    top: 20px;          /* Posicionado arriba */
    right: 20px;        /* Posicionado a la derecha */
    background: linear-gradient(to right, #10b981, #059669); /* Fondo verde */
    color: white;
    padding: 15px 20px;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4); /* Sombra verde para combinar */
    z-index: 2000;       /* Asegura que est√© por encima de todo */
    opacity: 0;          /* Oculto por defecto */
    transform: translateY(-20px); /* Posici√≥n inicial, un poco m√°s arriba */
    transition: opacity 0.4s ease, transform 0.4s ease; /* Animaci√≥n suave */
    font-weight: bold;
    font-size: 0.95rem;
    max-width: 300px;
    pointer-events: none; /* Evita que la notificaci√≥n bloquee clics */
}

.notification.show {
    opacity: 1;          /* Visible */
    transform: translateY(0); /* Posici√≥n final, en su lugar */
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <!-- Logo A√±adido -->
            <img src="https://i.imgur.com/qQ7aGbv.png" alt="Cancinfluencers Logo" class="header-logo">
            <h1>CANCINFLUENCERS</h1>
            <p class="subtitle">Descubre las canciones de tus influencers favoritos haciendo clic en las tarjetas</p>
        </header>

        <div class="controls">
            <input type="text" class="search-input" placeholder="Buscar influencer..." id="searchInput">
            <button class="btn shuffle-btn" id="shuffleBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="23 4 23 10 17 10"></polyline>
                    <polyline points="1 20 1 14 7 14"></polyline>
                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                </svg>
                Reordenar
            </button>
            <button class="btn add-btn" id="addBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                A√±adir Influencer
            </button>
            <button class="btn tierlist-btn" id="tierlistBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="7" height="7"></rect>
                    <rect x="14" y="3" width="7" height="7"></rect>
                    <rect x="14" y="14" width="7" height="7"></rect>
                    <rect x="3" y="14" width="7" height="7"></rect>
                </svg>
                Ver Tierlist
            </button>
            <button class="btn categories-btn" id="categoriesBtn">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                </svg>
                Categor√≠as
            </button>
        </div>

        <main>
            <div class="cards-grid" id="cardsGrid">
                <!-- Las tarjetas se generar√°n din√°micamente -->
            </div>
            
            <div class="no-results" id="noResults" style="display: none;">
                <p>No se encontraron influencers con ese nombre</p>
            </div>

            <!-- Toggle para canciones de fans -->
            <div class="fans-toggle-container">
                <div class="fans-toggle">
                    <span class="fans-label">üéµ Canciones de Fans</span>
                    <div class="toggle-switch" id="fansToggle">
                        <div class="toggle-slider"></div>
                    </div>
                </div>
                <div class="fans-count" id="fansCount">10 canciones disponibles</div>
            </div>

            <!-- Secci√≥n de canciones de fans -->
            <div class="fans-section" id="fansSection">
                <h2 class="fans-title">CANCIONES DE FANS</h2>
                <div class="cards-grid" id="fansCardsGrid">
                    <!-- Las tarjetas de fans se generar√°n din√°micamente -->
                </div>
            </div>
            
            <!-- Informaci√≥n de filtro activo -->
<div class="active-category" id="activeCategoryInfo" style="display: none;">
    <div class="active-category-name" id="activeCategoryName"></div>
    <button class="clear-filter-btn" id="clearFilterBtn">Limpiar filtro</button>
</div>

        <footer>
            <div class="footer-content">
                <div class="creator-info">
                    <span>Creado por</span>
                    <span class="creator-name">Maiquel3000</span>
                    <span>¬© 2025 - Todos los derechos reservados</span>
                </div>
                <div class="social-links">
                    <a href="https://www.instagram.com/miguel.gandia" target="_blank" class="social-link" title="S√≠gueme en Instagram">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zM5.838 12a6.162 6.162 0 1 1 12.324 0 6.162 6.162 0 0 1-12.324 0zM12 16a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm4.965-10.405a1.44 1.44 0 1 1 2.881.001 1.44 1.44 0 0 1-2.881-.001z"></path>
                        </svg>
                    </a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Modal para ver el video -->
    <div class="modal" id="videoModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modalTitle"></h3>
                <button class="close-btn" id="closeModal">√ó</button>
            </div>
            <div class="modal-body">
                <div class="modal-video">
                    <iframe id="modalVideo" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>
                </div>
                <div class="tier-selection-panel">
                    <div class="tier-selection-title">Selecciona un tier:</div>
                    <div class="tier-options">
                        <div class="tier-option tier-s" data-tier="s">S</div>
                        <div class="tier-option tier-a" data-tier="a">A</div>
                        <div class="tier-option tier-b" data-tier="b">B</div>
                        <div class="tier-option tier-c" data-tier="c">C</div>
                        <div class="tier-option tier-d" data-tier="d">D</div>
                        <div class="tier-option tier-f" data-tier="f">F</div>
                    </div>
                    <div class="tier-selection-status" id="tierSelectionStatus">Haz clic en un tier para clasificar esta canci√≥n</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para a√±adir influencer -->
    <div class="modal" id="addModal">
        <div class="add-modal-content">
            <div class="add-modal-header">
                <h2 class="add-modal-title">A√±adir Nuevo Influencer</h2>
            </div>
            
            <div class="success-message" id="successMessage">
                ¬°Influencer a√±adido correctamente!
            </div>
            
            <form id="addInfluencerForm">
                <div class="form-group">
                    <label class="form-label" for="influencerName">Nombre del Influencer</label>
                    <input type="text" class="form-input" id="influencerName" placeholder="Ej: ElRubius" required="">
                    <div class="error-message" id="nameError">Por favor, ingresa un nombre v√°lido</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="youtubeUrl">URL del Video de YouTube</label>
                    <input type="url" class="form-input" id="youtubeUrl" placeholder="https://www.youtube.com/watch?v=..." required="">
                    <div class="error-message" id="urlError">Por favor, ingresa una URL v√°lida de YouTube</div>
                </div>
                
                <div class="form-buttons">
                    <button type="button" class="form-btn cancel-btn" id="cancelAddBtn">Cancelar</button>
                    <button type="submit" class="form-btn submit-btn">A√±adir</button>
                </div>
            </form>
        </div>
    </div>

<!-- Modal para ver categor√≠as -->
<div class="modal" id="categoriesModal">
    <div class="categories-modal-content">
        <div class="categories-header">
            <h2 class="categories-title">CATEGOR√çAS DE INFLUENCERS</h2>
            <button class="close-btn" id="closeCategoriesModal">√ó</button>
        </div>
        
        <div class="category-stats">
            <div class="category-stat">
                <div class="category-stat-number" id="totalCategories">7</div>
                <div class="category-stat-label">Categor√≠as Disponibles</div>
            </div>
            <div class="category-stat">
                <div class="category-stat-number" id="totalInfluencers">130</div>
                <div class="category-stat-label">Total Influencers</div>
            </div>
        </div>
        
        <div class="filter-info">üí° Selecciona m√∫ltiples categor√≠as para filtrar influencers</div>
        
        <div class="selected-count" id="selectedCount" style="display: none;">
            0 categor√≠as seleccionadas
        </div>
        
        <div class="categories-container" id="categoriesContainer">
            <!-- Las categor√≠as se generar√°n din√°micamente -->
        </div>
        
        <div class="category-actions">
            <button class="apply-filters-btn" id="applyFiltersBtn">Aplicar filtros</button>
            <button class="clear-all-btn" id="clearAllBtn">Limpiar todo</button>
        </div>
    </div>
</div>

    <!-- Modal para ver tierlist -->
    <div class="modal" id="tierlistModal">
        <div class="tierlist-modal-content">
            <div class="tierlist-header">
                <h2 class="tierlist-title">MI TIERLIST</h2>
                <div class="tierlist-actions">
                    <button class="edit-tiers-btn" id="editTiersBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        Editar Nombres
                    </button>
                    <button class="close-btn" id="closeTierlistModal">√ó</button>
                </div>
            </div>
            
            <div class="tier-stats">
                <div class="tier-stat">
                    <div class="tier-stat-number" id="totalRevealed">0</div>
                    <div class="tier-stat-label">Canciones Reveladas</div>
                </div>
                <div class="tier-stat">
                    <div class="tier-stat-number" id="totalSongs">0</div>
                    <div class="tier-stat-label">Total Canciones</div>
                </div>
            </div>
            
            <div class="reorder-hint">üí° Arrastra y suelta los elementos para reordenar tu tierlist</div>
            
            <div class="tierlist-container">
                <div class="tier-row" data-tier="s">
                    <div class="tier-label tier-s">S</div>
                    <div class="tier-items" id="tier-s"></div>
                </div>
                
                <div class="tier-row" data-tier="a">
                    <div class="tier-label tier-a">A</div>
                    <div class="tier-items" id="tier-a"></div>
                </div>
                
                <div class="tier-row" data-tier="b">
                    <div class="tier-label tier-b">B</div>
                    <div class="tier-items" id="tier-b"></div>
                </div>
                
                <div class="tier-row" data-tier="c">
                    <div class="tier-label tier-c">C</div>
                    <div class="tier-items" id="tier-c"></div>
                </div>
                
                <div class="tier-row" data-tier="d">
                    <div class="tier-label tier-d">D</div>
                    <div class="tier-items" id="tier-d"></div>
                </div>
                
                <div class="tier-row" data-tier="f">
                    <div class="tier-label tier-f">F</div>
                    <div class="tier-items" id="tier-f"></div>
                </div>

                <!-- CATEGOR√çA SIN CLASIFICAR MOVIDA AL FINAL -->
                <div class="tier-row" data-tier="unclassified">
                    <div class="tier-label tier-unclassified">Sin Clasificar</div>
                    <div class="tier-items" id="tier-unclassified"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal para editar tiers -->
    <div class="modal" id="editTiersModal">
        <div class="edit-tiers-modal-content">
            <div class="edit-tiers-header">
                <h2 class="edit-tiers-title">Personalizar Nombres de Tiers</h2>
                <p class="edit-tiers-subtitle">Edita los nombres de tus tiers para personalizar tu experiencia</p>
            </div>
            
            <div class="tier-edit-group">
                <div class="tier-edit-label">
                    <div class="tier-color-preview tier-s"></div>
                    <span>Nombre del Tier S:</span>
                </div>
                <input type="text" class="tier-edit-input" id="tier-name-s" placeholder="Ej: Excelente, God Tier, S+">
            </div>
            
            <div class="tier-edit-group">
                <div class="tier-edit-label">
                    <div class="tier-color-preview tier-a"></div>
                    <span>Nombre del Tier A:</span>
                </div>
                <input type="text" class="tier-edit-input" id="tier-name-a" placeholder="Ej: Muy Bueno, Great, A+">
            </div>
            
            <div class="tier-edit-group">
                <div class="tier-edit-label">
                    <div class="tier-color-preview tier-b"></div>
                    <span>Nombre del Tier B:</span>
                </div>
                <input type="text" class="tier-edit-input" id="tier-name-b" placeholder="Ej: Bueno, Average, B+">
            </div>
            
            <div class="tier-edit-group">
                <div class="tier-edit-label">
                    <div class="tier-color-preview tier-c"></div>
                    <span>Nombre del Tier C:</span>
                </div>
                <input type="text" class="tier-edit-input" id="tier-name-c" placeholder="Ej: Regular, Average, C+">
            </div>
            
            <div class="tier-edit-group">
                <div class="tier-edit-label">
                    <div class="tier-color-preview tier-d"></div>
                    <span>Nombre del Tier D:</span>
                </div>
                <input type="text" class="tier-edit-input" id="tier-name-d" placeholder="Ej: Malo, Below Average, D+">
            </div>
            
            <div class="tier-edit-group">
                <div class="tier-edit-label">
                    <div class="tier-color-preview tier-f"></div>
                    <span>Nombre del Tier F:</span>
                </div>
                <input type="text" class="tier-edit-input" id="tier-name-f" placeholder="Ej: Terrible, Fail, F-">
            </div>
            
            <div class="edit-tiers-buttons">
                <button class="form-btn reset-tiers-btn" id="resetTiersBtn">Restablecer</button>
                <button class="form-btn save-tiers-btn" id="saveTiersBtn">Guardar Cambios</button>
            </div>
        </div>		
    </div>


    <script>

// --- C√ìDIGO DEL EASTER EGG (C√ìDIGO KONAMI - VERSI√ìN CORREGIDA) ---

const konamiCode = ['arrowup', 'arrowup', 'arrowdown', 'arrowdown', 'arrowleft', 'arrowright', 'arrowleft', 'arrowright', 'b', 'a'];
let konamiCodePosition = 0;

// Funci√≥n para activar el Easter Egg (sin cambios)
function triggerEasterEgg() {
    if (localStorage.getItem('cancinfluencers_easterEggActivated') === 'true') {
        showNotification('El Easter Egg ya fue descubierto.');
        konamiCodePosition = 0;
        return;
    }

    const easterEggInfluencer = {
        id: 'easter_egg_maiquel3k',
        name: 'Maiquel3k',
        youtubeUrl: 'https://www.youtube.com/watch?v=lfVKuIAdfRY',
        videoId: 'lfVKuIAdfRY',
        tier: 's'
    };

    mainInfluencersData.push(easterEggInfluencer);
    mainInfluencers.push(easterEggInfluencer);
    revealedCards.add(easterEggInfluencer.id);
    tierlistData.s.push(easterEggInfluencer);

    localStorage.setItem('cancinfluencers_easterEggActivated', 'true');
    saveRevealedCardsToLocalStorage();
    saveTierlistDataToLocalStorage();

    renderCards();
    updateTierlistStats();
    showNotification('üéâ ¬°C√≥digo Konami Activado! Encontraste el Easter egg!');
    openModal(easterEggInfluencer);
    konamiCodePosition = 0;
}

// Funci√≥n para cargar el Easter Egg si ya fue activado (sin cambios)
function loadEasterEgg() {
    if (localStorage.getItem('cancinfluencers_easterEggActivated') === 'true') {
        const easterEggInfluencer = {
            id: 'easter_egg_maiquel3k',
            name: 'Maiquel3k',
            youtubeUrl: 'https://www.youtube.com/watch?v=lfVKuIAdfRY',
            videoId: 'lfVKuIAdfRY',
            tier: 's'
        };
        
        if (!mainInfluencersData.find(i => i.id === easterEggInfluencer.id)) {
            mainInfluencersData.push(easterEggInfluencer);
            mainInfluencers.push(easterEggInfluencer);
            revealedCards.add(easterEggInfluencer.id);
        }
    }
}

// Listener para detectar el C√≥digo Konami (M√ÅS ROBUSTO)
document.addEventListener('keydown', function(e) {
    // Ignorar si el foco est√° en un campo de entrada de texto
    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.isContentEditable) {
        return;
    }

    // Usamos e.key.toLowerCase() para que funcione tanto con 'b' como con 'B'
    const key = e.key.toLowerCase();

    // Comprobamos si la tecla es la correcta en la secuencia
    if (key === konamiCode[konamiCodePosition]) {
        konamiCodePosition++;
        
        // Si se ha completado toda la secuencia
        if (konamiCodePosition === konamiCode.length) {
            triggerEasterEgg();
        }
    } else {
        // Si la tecla es incorrecta, reiniciar la secuencia
        konamiCodePosition = 0;
    }
});

    // --- FUNCIONES DE LOCALSTORAGE ---

    // Guardar el siguiente ID disponible
function saveNextIdToLocalStorage() {
    try {
        localStorage.setItem('cancinfluencers_nextId', nextId.toString());
    } catch (e) {
        console.error('Error al guardar nextId:', e);
    }
}

// Cargar el siguiente ID disponible
function loadNextIdFromLocalStorage() {
    try {
        const saved = localStorage.getItem('cancinfluencers_nextId');
        if (saved) {
            nextId = parseInt(saved, 10);
        }
    } catch (e) {
        console.error('Error al cargar nextId:', e);
    }
}

// Guardar las tarjetas reveladas
function saveRevealedCardsToLocalStorage() {
    try {
        const revealedArray = Array.from(revealedCards);
        localStorage.setItem('cancinfluencers_revealedCards', JSON.stringify(revealedArray));
    } catch (e) {
        console.error('Error al guardar tarjetas reveladas:', e);
    }
}

// Cargar las tarjetas reveladas
function loadRevealedCardsFromLocalStorage() {
    try {
        const saved = localStorage.getItem('cancinfluencers_revealedCards');
        if (saved) {
            const revealedArray = JSON.parse(saved);
            revealedCards = new Set(revealedArray);
        }
    } catch (e) {
        console.error('Error al cargar tarjetas reveladas:', e);
        revealedCards = new Set(); // Resetear a un Set vac√≠o en caso de error
    }
}

// Guardar los datos de la tierlist
function saveTierlistDataToLocalStorage() {
    try {
        localStorage.setItem('cancinfluencers_tierlistData', JSON.stringify(tierlistData));
    } catch (e) {
        console.error('Error al guardar datos de la tierlist:', e);
    }
}

// Cargar los datos de la tierlist
function loadTierlistDataFromLocalStorage() {
    try {
        const saved = localStorage.getItem('cancinfluencers_tierlistData');
        if (saved) {
            tierlistData = JSON.parse(saved);
        }
    } catch (e) {
        console.error('Error al cargar datos de la tierlist:', e);
        // Resetear a los valores por defecto en caso de error
        tierlistData = {
            unclassified: [],
            s: [],
            a: [],
            b: [],
            c: [],
            d: [],
            f: []
        };
    }
}

// Guardar la lista completa de influencers principales
function saveInfluencersDataToLocalStorage() {
    try {
        localStorage.setItem('cancinfluencers_mainInfluencersData', JSON.stringify(mainInfluencersData));
    } catch (e) {
        console.error('Error al guardar la lista de influencers:', e);
    }
}

// Cargar la lista completa de influencers principales
function loadInfluencersDataFromLocalStorage() {
    try {
        const saved = localStorage.getItem('cancinfluencers_mainInfluencersData');
        if (saved) {
            const loadedInfluencers = JSON.parse(saved);
            // Reemplazar el array original con el cargado
            mainInfluencersData.length = 0; // Vaciar el array original
            mainInfluencersData.push(...loadedInfluencers); // A√±adir los elementos cargados
        }
    } catch (e) {
        console.error('Error al cargar la lista de influencers:', e);
        // Si hay un error, se seguir√° usando la lista por defecto
    }
}

// Sincronizar los tiers de los influencers con los datos cargados
// ¬°Esta es la funci√≥n m√°s importante!
// FUNCI√ìN DEFINITIVA: syncInfluencerTiersFromLoadedData
function syncInfluencerTiersFromLoadedData() {
    // 1. Resetear todos los tiers en los datos maestros a null
    [...mainInfluencersData, ...fansInfluencersData].forEach(influencer => {
        influencer.tier = null;
    });

    // 2. Crear un conjunto (Set) con todos los IDs de los influencers clasificados
    const classifiedIds = new Set();
    Object.keys(tierlistData).forEach(tierKey => {
        // Ignorar la lista de 'unclassified' por ahora
        if (tierKey !== 'unclassified') {
            tierlistData[tierKey].forEach(influencer => {
                classifiedIds.add(influencer.id);
                // Actualizar el tier en los datos maestros
                const masterInfluencer = findInfluencerById(influencer.id);
                if (masterInfluencer) {
                    masterInfluencer.tier = tierKey;
                }
            });
        }
    });

    // 3. RE-CONSTRUIR la lista de 'unclassified' desde cero.
    // --- CORRECCI√ìN CLAVE: A√±adimos la condici√≥n de que est√© revelado ---
    tierlistData.unclassified = [...mainInfluencersData, ...fansInfluencersData].filter(influencer => 
        !classifiedIds.has(influencer.id) && revealedCards.has(influencer.id)
    );
}
        // Datos de los influencers principales - LISTA ACTUALIZADA CON CATEGOR√çAS
    const mainInfluencersData = [
        { id: '1', name: 'OllieGamerZ', youtubeUrl: 'https://www.youtube.com/watch?v=62pWsLpR8so', videoId: '62pWsLpR8so', tier: null, categories: ['Minecraft', 'Espa√±oles'] },
        { id: '2', name: 'DalasReview', youtubeUrl: 'https://youtu.be/oMGHCWXNBOU?si=LuSrD52-_GmyEG1q', videoId: 'oMGHCWXNBOU', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '3', name: 'ElRubiusOMG', youtubeUrl: 'https://www.youtube.com/watch?v=VZzSBv6tXMw', videoId: 'VZzSBv6tXMw', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '4', name: 'ElRubius', youtubeUrl: 'https://youtu.be/OkFOETs00QA?si=oX9m0GMS6CI3KfaA', videoId: 'OkFOETs00QA', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '5', name: 'Ibai', youtubeUrl: 'https://www.youtube.com/watch?v=n66zQBqwI9A', videoId: 'n66zQBqwI9A', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '6', name: 'Robleis', youtubeUrl: 'https://youtu.be/GpFoGiscj7k?si=y_jc2UR1T4uAhzOT', videoId: 'GpFoGiscj7k', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '7', name: 'Agustin51', youtubeUrl: 'https://youtu.be/YNwg-tWMyyY?si=UtRJSu8xqDksTig_', videoId: 'YNwg-tWMyyY', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '8', name: 'RickyEdit', youtubeUrl: 'https://youtu.be/Y0VM6DtwM8g?si=k-QlE6h54mNYBrpP', videoId: 'Y0VM6DtwM8g', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '9', name: 'illojuan', youtubeUrl: 'https://youtu.be/65o77VtTcEk?si=Wj9TiQkPIk9lyyGF', videoId: '65o77VtTcEk', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '10', name: 'YoSoyPlex', youtubeUrl: 'https://youtu.be/7lQfj-_8Zg0?si=T3VR9-vxskBU9W4f', videoId: '7lQfj-_8Zg0', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '11', name: 'Xokas', youtubeUrl: 'https://youtu.be/0j3R4_PED1Q?si=l-r6wd7ZqXFCQMa3', videoId: '0j3R4_PED1Q', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '12', name: 'Karina', youtubeUrl: 'https://youtu.be/kKKgU8xf3qI?si=LsiA3A_7pA5TcyA5', videoId: 'kKKgU8xf3qI', tier: null, categories: ['Latinos'] },
        { id: '13', name: 'Mikecrack', youtubeUrl: 'https://youtu.be/TaQj43Lf3tw?si=hKMDcCz0IByWk6en', videoId: 'TaQj43Lf3tw', tier: null, categories: ['Mainstream', 'Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '14', name: 'Fede', youtubeUrl: 'https://youtu.be/CHeEEyi8Y-g?si=Qko7o2ii8PDm_QiP', videoId: 'CHeEEyi8Y-g', tier: null, categories: ['Ni√±os', 'Latinos'] },
        { id: '15', name: 'Salva (DualCoC)', youtubeUrl: 'https://youtu.be/XJaLFrYe6mk?si=_lCu3wxi7h2ZNNRl', videoId: 'XJaLFrYe6mk', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '16', name: 'Nil Ojeda', youtubeUrl: 'https://youtu.be/9DhPBgrSIaA?si=hZ5amS1ePWWjRAWp', videoId: '9DhPBgrSIaA', tier: null, categories: ['Mainstream', 'Minecraft', 'Espa√±oles'] },
        { id: '17', name: 'Goorgo', youtubeUrl: 'https://youtu.be/-zeayRzldyI?si=KRUk_-L5UDA6e02L', videoId: '-zeayRzldyI', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '18', name: 'Willyrex', youtubeUrl: 'https://youtu.be/CW9uky3MZXM?si=0h8nlM-VDBJ1VwU6', videoId: 'CW9uky3MZXM', tier: null, categories: ['Mainstream', 'Minecraft', 'Espa√±oles'] },
        { id: '19', name: 'WhiteZunder', youtubeUrl: 'https://youtu.be/rN7mwzCICn0?si=ob-Gm5K1DaEeEXWT', videoId: 'rN7mwzCICn0', tier: null, categories: ['Minecraft', 'Espa√±oles'] },
        { id: '20', name: 'MissaSinfonia', youtubeUrl: 'https://youtu.be/iuQoT2hUVjk?si=LGj6HQ5_aFpjPFc3', videoId: 'iuQoT2hUVjk', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '21', name: 'YellowMellow', youtubeUrl: 'https://youtu.be/Bnip21mbOD0?si=wdIeziNpbaafhPR_', videoId: 'Bnip21mbOD0', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '22', name: 'Spreen', youtubeUrl: 'https://youtu.be/5rjCRPG3mkw?si=Ndpw-VX17K-KScZ1', videoId: '5rjCRPG3mkw', tier: null, categories: ['Mainstream', 'Minecraft', 'Latinos'] },
        { id: '23', name: 'Carreraa', youtubeUrl: 'https://youtu.be/oE2rfyhIsuk?si=F067GpyMxTXkTSNw', videoId: 'oE2rfyhIsuk', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '24', name: 'JuanGuarnizo', youtubeUrl: 'https://youtu.be/VoN4x3R0TCQ?si=OrIQXpTTTNYoqQbu', videoId: 'VoN4x3R0TCQ', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '25', name: 'AriGameplays', youtubeUrl: 'https://youtu.be/aHYvmY3nV5U?si=5uOMvcyJPG3KiMaC', videoId: 'aHYvmY3nV5U', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '26', name: 'Fernanfloo', youtubeUrl: 'https://youtu.be/3oY5qoqo7Mg?si=dV-6B72Wrewrk85g', videoId: '3oY5qoqo7Mg', tier: null, categories: ['Mainstream', 'Viejas Reliquias', 'Latinos'] },
        { id: '27', name: 'German Garmendia', youtubeUrl: 'https://youtu.be/9EmXVhPsJQQ?si=lup3rdjHQENE5dF2', videoId: '9EmXVhPsJQQ', tier: null, categories: ['Mainstream', 'Viejas Reliquias', 'Latinos'] },
        { id: '28', name: 'rojuu', youtubeUrl: 'https://youtu.be/wxKBvF2pS_A?si=avaObdkacZ-OAnzH', videoId: 'wxKBvF2pS_A', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '29', name: 'Orslok', youtubeUrl: 'https://youtu.be/xMAmnQgV6ss?si=oeXwqY5Tmsh91oq4', videoId: 'xMAmnQgV6ss', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '30', name: 'Oscu', youtubeUrl: 'https://youtu.be/TXu9N_zhSZE?si=m7StAyOjApZ_dZWR', videoId: 'TXu9N_zhSZE', tier: null, categories: ['Espa√±oles'] },
        { id: '31', name: 'Angie Velasco', youtubeUrl: 'https://youtu.be/1C1awEClK84?si=yCXeBmoS4xPcsbYk', videoId: '1C1awEClK84', tier: null, categories: ['Latinos'] },
        { id: '32', name: 'Alondrissa', youtubeUrl: 'https://youtu.be/yU1_NmePLFg?si=GNIZBYj8HzxpImvI', videoId: 'yU1_NmePLFg', tier: null, categories: ['Latinos'] },
        { id: '33', name: 'Coscu', youtubeUrl: 'https://youtu.be/87y1ZCFFYqc?si=cLCot9mK3ocPXVmv', videoId: '87y1ZCFFYqc', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '34', name: 'RobertoCein', youtubeUrl: 'https://youtu.be/LSXw8cketoc?si=yJE8Ie3UettzDjjZ', videoId: 'LSXw8cketoc', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '35', name: 'Rodezel', youtubeUrl: 'https://youtu.be/ZXpk7tv47kc?si=PM_58WfB2_HtdcnU', videoId: 'ZXpk7tv47kc', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '36', name: 'Nuvia', youtubeUrl: 'https://youtu.be/S2eQjr_MXIE?si=QVD8_kx8oZJxcbzw', videoId: 'S2eQjr_MXIE', tier: null, categories: ['Latinos'] },
        { id: '37', name: 'ElMariana', youtubeUrl: 'https://youtu.be/vcdxMNgHTrc?si=aTppOKFNuN2zCbRe', videoId: 'vcdxMNgHTrc', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '38', name: 'Komanche', youtubeUrl: 'https://youtu.be/gSTwJTgYm3I?si=i_b-F8xxuj-pFnWC', videoId: 'gSTwJTgYm3I', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '39', name: 'Lyna Vallejos', youtubeUrl: 'https://youtu.be/zFJAX23KIh8?si=mK2BUoC3r39n1tmy', videoId: 'zFJAX23KIh8', tier: null, categories: ['Ni√±os', 'Latinos'] },
        { id: '40', name: 'Wismichu', youtubeUrl: 'https://youtu.be/FBGE-ptCGT8?si=hwGhfGzTAixN834h', videoId: 'FBGE-ptCGT8', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '41', name: 'Yao Cabrera', youtubeUrl: 'https://youtu.be/t4sAPvqKlgw?si=B5RAil8nl2Rwri9G', videoId: 't4sAPvqKlgw', tier: null, categories: ['Mainstream', 'Viejas Reliquias', 'Latinos', 'Ni√±os'] },
        { id: '42', name: 'Jordi Wild', youtubeUrl: 'https://youtu.be/IHD4zT8a4Lg?si=pqXBJiSNl3gYqOnZ', videoId: 'IHD4zT8a4Lg', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '43', name: 'Momo', youtubeUrl: 'https://youtu.be/5EouEAo9wy0?si=U_AuI-TGIdDT0yqB', videoId: '5EouEAo9wy0', tier: null, categories: ['Latinos'] },
        { id: '44', name: 'J√§gger', youtubeUrl: 'https://youtu.be/gLsMfF5m08Y?si=_WzBUhccKEkMecL0', videoId: 'gLsMfF5m08Y', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '45', name: 'Maximus', youtubeUrl: 'https://youtu.be/1LnTBgw-aGU?si=r9QeEt4ol_mjx27_', videoId: '1LnTBgw-aGU', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '46', name: 'Zorman', youtubeUrl: 'https://youtu.be/h6k5qbt72Os?si=Ajt_Qi0eREYWAXse', videoId: 'h6k5qbt72Os', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '47', name: 'Jaime Altozano', youtubeUrl: 'https://youtu.be/ziJuNQcJn24?si=iR34OM4NZZWAw2-C', videoId: 'ziJuNQcJn24', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '48', name: 'Corxea (Spaceronin7)', youtubeUrl: 'https://youtu.be/DMXdutHKJls?si=n-XHphP-3TuGBLPK', videoId: 'DMXdutHKJls', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles', 'Latinos'] },
        { id: '49', name: 'Jpelirrojo', youtubeUrl: 'https://youtu.be/UJGQaUu-uzA?si=8Twqa8vLKnC6GtRL', videoId: 'UJGQaUu-uzA', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '50', name: 'Wescol', youtubeUrl: 'https://youtu.be/EY47yXiQ1yM?t=172', videoId: 'EY47yXiQ1yM', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles', 'Latinos'] },
        { id: '51', name: 'Wescol2', youtubeUrl: 'https://youtu.be/o2eqeodAHj8?si=w70M-xaDCQTsiWZj', videoId: 'o2eqeodAHj8', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles', 'Latinos'] },
        { id: '52', name: 'DaniRep 2017', youtubeUrl: 'https://youtu.be/Wq6qp5ZsduY?si=nRyC-_HG88Zc2BZG', videoId: 'Wq6qp5ZsduY', tier: null, categories: ['Mainstream', 'Viejas Reliquias', 'Espa√±oles'] },
        { id: '53', name: 'DaniRep Actual', youtubeUrl: 'https://youtu.be/ZgkkEcx03Xw?si=KysF_254s-3L42aB', videoId: 'ZgkkEcx03Xw', tier: null, categories: ['Mainstream', 'Viejas Reliquias', 'Espa√±oles'] },
        { id: '54', name: 'MAAU,Ô∏è‚ÄçPUVLO,LATE,URIEL- ONE COIN', youtubeUrl: 'https://youtu.be/vPN4WNZxxxE?si=LEF5lXNaUAJUJ-CX', videoId: 'vPN4WNZxxxE', tier: null, categories: ['Latinos'] },
        { id: '55', name: 'LATE', youtubeUrl: 'https://youtu.be/zKO2FJEEVsw?si=vGiMHXz0ZUyoDZD8', videoId: 'zKO2FJEEVsw', tier: null, categories: ['Latinos'] },
        { id: '56', name: 'Cry', youtubeUrl: 'https://youtu.be/rsfosxNojKc?si=AgwS8OncESvkmSAS', videoId: 'rsfosxNojKc', tier: null, categories: ['Mainstream', 'Viejas Reliquias', 'Espa√±oles'] },
        { id: '57', name: 'Capit√°n Gato', youtubeUrl: 'https://youtu.be/XG3_pbsUcCA?si=LjKx3Wg6RuuOA3h5', videoId: 'XG3_pbsUcCA', tier: null, categories: ['Latinos'] },
        { id: '58', name: 'StarVTuber', youtubeUrl: 'https://youtu.be/ZyDUc1h582U?si=xFNdopPqw3l9HrqI', videoId: 'ZyDUc1h582U', tier: null, categories: ['Latinos'] },
        { id: '59', name: 'Naim Darrechi', youtubeUrl: 'https://youtu.be/zFch_ru4eaI?si=iT8RliEeiaowSlkX', videoId: 'zFch_ru4eaI', tier: null, categories: ['Viejas Reliquias', 'Tiktokers', 'Espa√±oles'] },
        { id: '60', name: 'Quackity', youtubeUrl: 'https://youtu.be/shniqa1sH_o?si=M4AbxTSYJnk7yN2m', videoId: 'shniqa1sH_o', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '61', name: 'Alana (participaci√≥n corta)', youtubeUrl: 'https://youtu.be/UGTCE1W81jg?si=Q5wuEi1WYPhxwCz6', videoId: 'UGTCE1W81jg', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '62', name: 'Alana', youtubeUrl: 'https://youtu.be/Ue8dX791o18?si=HmXcxYqADFCYcxxm', videoId: 'Ue8dX791o18', tier: null, categories: ['Mainstream', 'Latinos'] },
        { id: '63', name: 'Yuya', youtubeUrl: 'https://youtu.be/SNa5Z8W-70I?si=P1rZtF_cSw8Vq-xL', videoId: 'SNa5Z8W-70I', tier: null, categories: ['Latinos'] },
        { id: '64', name: 'Masi', youtubeUrl: 'https://youtu.be/GoMGw4BkhfM?si=O3AhXZrpktcvTYv5', videoId: 'GoMGw4BkhfM', tier: null, categories: ['Mainstream', 'Ni√±os', 'Espa√±oles'] },
        { id: '65', name: 'Guanyar,Misho Amoli,Nil Ojeda', youtubeUrl: 'https://youtu.be/5BYBDd_udCk?si=7aft3sem3RLMnuy0', videoId: '5BYBDd_udCk', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '66', name: 'Cristinini', youtubeUrl: 'https://youtu.be/RP4gxh-yqLs?si=fLNzyotoujEFxHCY', videoId: 'RP4gxh-yqLs', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '67', name: 'clersssss', youtubeUrl: 'https://youtu.be/cUydAxe0CYM?si=MEf_6LZELWQ-YUC_', videoId: 'cUydAxe0CYM', tier: null, categories: ['Mainstream', 'Tiktokers', 'Espa√±oles'] },
        { id: '68', name: 'caprimint', youtubeUrl: 'https://youtu.be/2BZ3g0CaMQQ?si=4Wjag-tOXaxotUoA', videoId: '2BZ3g0CaMQQ', tier: null, categories: ['Latinos'] },
        { id: '69', name: 'Bb trickz', youtubeUrl: 'https://youtu.be/C8WmCFg65C0?si=4zs8KrELlgsgzSr3', videoId: 'C8WmCFg65C0', tier: null, categories: ['Mainstream', 'Tiktokers', 'Espa√±oles'] },
        { id: '70', name: 'Ruth \'La Peke\'', youtubeUrl: 'https://youtu.be/1dtugsaskAQ?si=m6p-XI6r6oWgQGQc', videoId: '1dtugsaskAQ', tier: null, categories: ['Mainstream', 'Tiktokers', 'Espa√±oles'] },
        { id: '71', name: 'Yeri Mua', youtubeUrl: 'https://youtu.be/eJS0WziQHGw?si=fPaqhoxlsRISDeQr', videoId: 'eJS0WziQHGw', tier: null, categories: ['Latinos'] },
        { id: '72', name: 'Arta', youtubeUrl: 'https://youtu.be/SZh1lPZX9XY?si=SRIqwOe1Aw3QegKL', videoId: 'SZh1lPZX9XY', tier: null, categories: ['Ni√±os', 'Espa√±oles'] },
        { id: '73', name: 'vMario', youtubeUrl: 'https://youtu.be/qv9jUOXLK30?si=nOwybGC2jliOl_Hb', videoId: 'qv9jUOXLK30', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '74', name: 'Yolo', youtubeUrl: 'https://youtu.be/Hblc4xt-9Pc?si=f1T9IifozX-Z5dsW', videoId: 'Hblc4xt-9Pc', tier: null, categories: ['Ni√±os', 'Latinos'] },
        { id: '75', name: 'Ricky Limon', youtubeUrl: 'https://youtu.be/xuNObVb4LpM?si=kIs07PztOu99z-du', videoId: 'xuNObVb4LpM', tier: null, categories: ['Ni√±os', 'Latinos'] },
        { id: '76', name: 'Susy Mouriz', youtubeUrl: 'https://youtu.be/K-zVyV0yuZU?si=v5ACXZV1oap98jow', videoId: 'K-zVyV0yuZU', tier: null, categories: ['Ni√±os', 'Latinos'] },
        { id: '77', name: 'ChuyMine', youtubeUrl: 'https://youtu.be/bpCEZ49hQMU?si=-3dxMVktwaev3aFC', videoId: 'bpCEZ49hQMU', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '78', name: 'xTurbo', youtubeUrl: 'https://youtu.be/cedhJXxVayE?si=8GNMg8DL0KBDPUlJ', videoId: 'cedhJXxVayE', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '79', name: 'Awita', youtubeUrl: 'https://youtu.be/GEgHoQtCWto?si=zlIG97iXBewHWv1O', videoId: 'GEgHoQtCWto', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '80', name: 'Jardred', youtubeUrl: 'https://youtu.be/JBJYfWHSMY4?si=rXSVwT3RdAu4ioJg', videoId: 'JBJYfWHSMY4', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '81', name: 'Elo YT', youtubeUrl: 'https://youtu.be/V5mMG7EdHGg?si=bEwYwQs6CbHRqDbZ', videoId: 'V5mMG7EdHGg', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '82', name: 'Arsel', youtubeUrl: 'https://youtu.be/EVDvU4ejh3M?si=KBZgxCldNXgXItTA', videoId: 'EVDvU4ejh3M', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '83', name: 'iTownGamePlay', youtubeUrl: 'https://youtu.be/-0xzODfv9aw?si=7K3gRO3I9Z0Q26pT', videoId: '-0xzODfv9aw', tier: null, categories: ['Mainstream', 'Minecraft', 'Espa√±oles'] },
        { id: '84', name: 'KillerCreeper55', youtubeUrl: 'https://youtu.be/T843uWKiW4g?si=4in1cW-DK-pUHIXx', videoId: 'T843uWKiW4g', tier: null, categories: ['Minecraft', 'Espa√±oles'] },
        { id: '85', name: 'Farfadox', youtubeUrl: 'https://youtu.be/7SO1uxxzqa8?si=MFp41IasWmDr5WeN', videoId: '7SO1uxxzqa8', tier: null, categories: ['Minecraft', 'Espa√±oles', 'Latinos'] },
        { id: '86', name: 'iLeoVlogs', youtubeUrl: 'https://youtu.be/6SeJxBXKnj4?si=CUeANi9t81KC0nS1', videoId: '6SeJxBXKnj4', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '87', name: 'iLeoVlogs (Parodia)', youtubeUrl: 'https://youtu.be/Hi6QsZTpbg4?si=A5ooIPHeDo7-ZgYe', videoId: 'Hi6QsZTpbg4', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '88', name: 'Agapito', youtubeUrl: 'https://youtu.be/KOpiio8fWxk?si=Iq6xpIzXYY66r16I', videoId: 'KOpiio8fWxk', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '89', name: 'Exi', youtubeUrl: 'https://youtu.be/UXjC9CdRumg?si=YKZhmTnCsICcFBQm', videoId: 'UXjC9CdRumg', tier: null, categories: ['Mainstream', 'Minecraft', 'Ni√±os', 'Tiktokers', 'Espa√±oles'] },
        { id: '90', name: 'Joaquinpa', youtubeUrl: 'https://youtu.be/sZyT29vwxXU?si=4UeYQo8PA4hzj8aG', videoId: 'sZyT29vwxXU', tier: null, categories: ['Mainstream', 'Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '91', name: 'Jokki', youtubeUrl: 'https://youtu.be/RYrSxuaend4?si=4pvCBxMKhuPNoE-m', videoId: 'RYrSxuaend4', tier: null, categories: ['Mainstream', 'Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '92', name: 'RoEnLaRed', youtubeUrl: 'https://youtu.be/u_jaF3BhGW0?si=HY2pAYbe9GsiguMa', videoId: 'u_jaF3BhGW0', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '93', name: 'TheDaarick28', youtubeUrl: 'https://youtu.be/P2RIdVV1tdM?si=q2E6LIriBMwBTDxf', videoId: 'P2RIdVV1tdM', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles', 'Latinos'] },
        { id: '94', name: 'Celopan', youtubeUrl: 'https://youtu.be/7xOOOn27kOQ?si=Y3GjyEvFXfTWAFBB', videoId: '7xOOOn27kOQ', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '95', name: 'WindyGirk', youtubeUrl: 'https://youtu.be/Vs0EaVF11hE?si=Vmn2tB7zZ3ZygalZ', videoId: 'Vs0EaVF11hE', tier: null, categories: ['Viejas Reliquias', 'Latinos'] },
        { id: '96', name: 'Kajal Napalm', youtubeUrl: 'https://youtu.be/KCHIZjiq7xE?si=2sjBnFR2TaZBvHbm', videoId: 'KCHIZjiq7xE', tier: null, categories: ['Viejas Reliquias', 'Espa√±oles'] },
        { id: '97', name: 'Angie Corine', youtubeUrl: 'https://youtu.be/MaOTXphstBg?si=OfkLPmXSILnKP7-d', videoId: 'MaOTXphstBg', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '98', name: 'Carla Laubalo', youtubeUrl: 'https://youtu.be/RpBy2THK-PM?si=yKiVuYebNbAHkyfm', videoId: 'RpBy2THK-PM', tier: null, categories: ['Espa√±oles'] },
        { id: '99', name: 'Epidemic77', youtubeUrl: 'https://youtu.be/uuoL1k_gaeA?si=elNc8BLbq9R9R8uM', videoId: 'uuoL1k_gaeA', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '100', name: 'Manucraft (Parodia)', youtubeUrl: 'https://youtu.be/TIasEF9dfes?si=2QdupINBZOzhzRLx', videoId: 'TIasEF9dfes', tier: null, categories: ['Minecraft', 'Espa√±oles'] },
        { id: '101', name: 'Manucraft', youtubeUrl: 'https://youtu.be/g41QnkH1YhQ?si=-dldElbvDXL0ytS6', videoId: 'g41QnkH1YhQ', tier: null, categories: ['Minecraft', 'Espa√±oles'] },
        { id: '102', name: 'Tatito Tales', youtubeUrl: 'https://youtu.be/ySw9EG4dmRk?si=gC9cF-NMWNcodMB1', videoId: 'ySw9EG4dmRk', tier: null, categories: ['Minecraft', 'Latinos'] },
        { id: '103', name: 'invictor', youtubeUrl: 'https://youtu.be/e57xlonP88A?si=6xzONAlZWAqXSKUv', videoId: 'e57xlonP88A', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '104', name: 'Timba Vk', youtubeUrl: 'https://youtu.be/s20ZdAFqCn0?si=2FYXt8kk_fIhdvxS', videoId: 's20ZdAFqCn0', tier: null, categories: ['Minecraft', 'Latinos'] },
        { id: '105', name: 'RaptorGamer', youtubeUrl: 'https://youtu.be/KXmHxcsBuG4?si=9skJma9aQrc-iYbc', videoId: 'KXmHxcsBuG4', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '106', name: 'Alexy', youtubeUrl: 'https://youtu.be/3ttJD7jeTH0?si=ovvw7YFHWD-dCk3L', videoId: '3ttJD7jeTH0', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '107', name: 'ElTrollino', youtubeUrl: 'https://youtu.be/6NpTJleajBs?si=loRFm64a2-Lcv2b3', videoId: '6NpTJleajBs', tier: null, categories: ['Minecraft', 'Latinos'] },
        { id: '108', name: 'Apixelados', youtubeUrl: 'https://youtu.be/oh_35zaKOoA?si=rzvZrQPTkckAoR_W', videoId: 'oh_35zaKOoA', tier: null, categories: ['Minecraft', 'Espa√±oles'] },
        { id: '109', name: 'Bobicraft', youtubeUrl: 'https://youtu.be/GjS4lAc2Yjc?si=Uk-qGZj-O1qtOTEA', videoId: 'GjS4lAc2Yjc', tier: null, categories: ['Minecraft', 'Latinos'] },
        { id: '110', name: 'Tina S√°nchez', youtubeUrl: 'https://youtu.be/woZCjjamUFM?si=CtEH8S8Gbm0dqAo1', videoId: 'woZCjjamUFM', tier: null, categories: ['Espa√±oles'] },
        { id: '111', name: 'BPancri', youtubeUrl: 'https://youtu.be/Kvx-jVZDzxc?si=xRNPnag8FRUaOhrP', videoId: 'Kvx-jVZDzxc', tier: null, categories: ['Minecraft', 'Ni√±os', 'Espa√±oles'] },
        { id: '112', name: 'Jacky (CooLifeGame)', youtubeUrl: 'https://youtu.be/LmSNELQ6Tuc?si=sqYsxvtNaEnk1mgT', videoId: 'LmSNELQ6Tuc', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '113', name: 'byViruZz', youtubeUrl: 'https://youtu.be/11YP9CA3tLk?si=rsN-zLG4Vmhnqmz6', videoId: '11YP9CA3tLk', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '114', name: 'Brunenger', youtubeUrl: 'https://youtu.be/WmXAqa8KwIQ?si=BC_EqNpqluaYUpFo', videoId: 'WmXAqa8KwIQ', tier: null, categories: ['Mainstream', 'Espa√±oles', 'Latinos'] },
        { id: '115', name: 'Folagor03', youtubeUrl: 'https://youtu.be/p7mpr5qyB3o?si=UY2fzewp_kOBBM13', videoId: 'p7mpr5qyB3o', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '116', name: 'Amouranth', youtubeUrl: 'https://youtu.be/3w597wLFSxg?si=e3wBpNajaoHGsFCL', videoId: '3w597wLFSxg', tier: null, categories: ['Mainstream'] },
        { id: '117', name: 'Papi Gavi', youtubeUrl: 'https://youtu.be/5MTiv9UGAhQ?si=fSxqIzFgBYwZNH6I', videoId: '5MTiv9UGAhQ', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '118', name: 'Ampeterby7', youtubeUrl: 'https://youtu.be/5rlEM7-nazc?si=5SiPxUNDSAoi8aSV', videoId: '5rlEM7-nazc', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '119', name: 'TheGrefg', youtubeUrl: 'https://youtu.be/JG1-ciVWqIA?si=ZNaqBrWSe2QWIxNc', videoId: 'JG1-ciVWqIA', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '120', name: 'JHdelacruz777', youtubeUrl: 'https://youtu.be/jlskG_ett5M?si=8V6jF9BeMH56OdBo', videoId: 'jlskG_ett5M', tier: null, categories: ['Tiktokers', 'Latinos'] },
        { id: '121', name: 'Lolito Fdez', youtubeUrl: 'https://youtu.be/aLgEOEXitLI?si=gKRJuAIbR7BokT2v', videoId: 'aLgEOEXitLI', tier: null, categories: ['Mainstream', 'Espa√±oles'] },
        { id: '122', name: 'Erra,Juan Beato', youtubeUrl: 'https://youtu.be/WqH9c5Z8EBQ?si=3Q98p8reM6LCvMw8', videoId: 'WqH9c5Z8EBQ', tier: null, categories: ['Mainstream', 'Tiktokers', 'Espa√±oles'] },
        { id: '123', name: 'El Cejas', youtubeUrl: 'https://youtu.be/okf2nQC2R1E?si=f65BJ0MMvoAv9BW0', videoId: 'okf2nQC2R1E', tier: null, categories: ['Tiktokers', 'Espa√±oles'] },
        { id: '124', name: 'Hamza Zaidi', youtubeUrl: 'https://youtu.be/4VEW-sHCvU4?si=uBmfUZ9oAP2eSecs', videoId: '4VEW-sHCvU4', tier: null, categories: ['Tiktokers', 'Espa√±oles'] },
        { id: '125', name: 'Dudu', youtubeUrl: 'https://youtu.be/xhI3DA2SXg8?si=dYyjcLhdIH39m8wm', videoId: 'xhI3DA2SXg8', tier: null, categories: ['Espa√±oles'] },
        { id: '126', name: 'Mar Lucas', youtubeUrl: 'https://youtu.be/dLiOguzsKOo?si=Hd1Z33X_NglUNMoK', videoId: 'dLiOguzsKOo', tier: null, categories: ['Tiktokers', 'Latinos'] },
        { id: '127', name: 'Paula Gonu', youtubeUrl: 'https://youtu.be/_IX4pzXqDZU?si=jhOXXPQ2ySfnhf44', videoId: '_IX4pzXqDZU', tier: null, categories: ['Tiktokers', 'Espa√±oles'] },
        { id: '128', name: 'Paul Ferrer', youtubeUrl: 'https://youtu.be/HzHKUCl4DMU?si=yxyU0UMCp9uWSGmc', videoId: 'HzHKUCl4DMU', tier: null, categories: ['Tiktokers', 'Espa√±oles'] },
        { id: '129', name: 'La Xinni', youtubeUrl: 'https://youtu.be/8P1snc4Cbeg?si=fvOi9eNCotE6O214', videoId: '8P1snc4Cbeg', tier: null, categories: ['Tiktokers', 'Espa√±oles'] },
        { id: '130', name: 'Twin Melody', youtubeUrl: 'https://youtu.be/5zm0Nx8MpiU?si=ftMJNIyMAYqRKjRT', videoId: '5zm0Nx8MpiU', tier: null, categories: ['Tiktokers', 'Espa√±oles'] }
    ];

        // Datos de las canciones de fans - LISTA ACTUALIZADA
        const fansInfluencersData = [
            { id: '131', name: 'Aroyitt', youtubeUrl: 'https://youtu.be/8M7qoUtjixc?si=EU4KEjHiUfGijMCv', videoId: '8M7qoUtjixc', tier: null },
            { id: '132', name: 'Aroyitt (Cover)', youtubeUrl: 'https://youtu.be/BW3BGT3YqjU?si=3p7bsvmlUkVMSVYZ', videoId: 'BW3BGT3YqjU', tier: null },
            { id: '133', name: 'Vegetta777', youtubeUrl: 'https://youtu.be/s1cj9Htf-Mg?si=zegfPcCQpNYzKyoo', videoId: 's1cj9Htf-Mg', tier: null },
            { id: '134', name: 'Rivers', youtubeUrl: 'https://youtu.be/a2VX-d1kezY?si=k-FAHtTljrvteKL8', videoId: 'a2VX-d1kezY', tier: null },
            { id: '135', name: 'Luzu', youtubeUrl: 'https://youtu.be/De8cf9txw-M?si=LRo6KmtxidezXFOH', videoId: 'De8cf9txw-M', tier: null },
            { id: '136', name: 'Axozer (cover bichota)', youtubeUrl: 'https://youtu.be/_XPC_1ENvqs?si=59jnOVwdR2sVMAzs', videoId: '_XPC_1ENvqs', tier: null },
            { id: '137', name: 'AuronPlay', youtubeUrl: 'https://youtu.be/82bb3TZLj9g?si=NTzpk5CcGXgAKJps', videoId: '82bb3TZLj9g', tier: null },
            { id: '138', name: 'Elisa Waves', youtubeUrl: 'https://youtu.be/IQfvNIscci8?si=n2B3TJLJ3971mpfP', videoId: 'IQfvNIscci8', tier: null },
            { id: '139', name: 'Reborn', youtubeUrl: 'https://youtu.be/IgXqlS5QTfg?si=ADaP-J-k-l7t3jJt', videoId: 'IgXqlS5QTfg', tier: null },
            { id: '140', name: 'Fernanfloo', youtubeUrl: 'https://youtu.be/uHjW3zxbyf4?si=aRUlqUQIPCSJKqhf', videoId: 'uHjW3zxbyf4', tier: null },
            { id: '141', name: 'ElRichMC', youtubeUrl: 'https://youtu.be/CbAGFpjNGdM?si=EN5gv8GkZ8ndtOXP', videoId: 'CbAGFpjNGdM', tier: null },
            { id: '142', name: 'RedstoneCanarias', youtubeUrl: 'https://youtu.be/cWJmkyfAqhA?si=DRXGzXqf5gFrVtYi', videoId: 'cWJmkyfAqhA', tier: null }
        ];


        // Variables globales
        let selectedCategories = new Set(); // CAMBIO: Ahora es un Set para m√∫ltiples categor√≠as
        let categoriesData = {}; // Se llenar√° din√°micamente
        let mainInfluencers = [...mainInfluencersData];
        let fansInfluencers = [...fansInfluencersData];
        let revealedCards = new Set();
        let isModalOpen = false;
        let nextId = 143;
        let fansToggleActive = false;
        let currentInfluencer = null;
        let draggedElement = null;
        let draggedInfluencer = null;
        let isTierlistModalOpen = false; // <-- A√ëADE ESTA L√çNEA

        // Nombres personalizados de tiers
        let customTierNames = {
            s: 'S',
            a: 'A',
            b: 'B',
            c: 'C',
            d: 'D',
            f: 'F'
        };

        // Funci√≥n para cargar nombres personalizados desde localStorage
        function loadCustomTierNames() {
            const saved = localStorage.getItem('customTierNames');
            if (saved) {
                try {
                    customTierNames = JSON.parse(saved);
                } catch (e) {
                    console.error('Error al cargar nombres personalizados:', e);
                }
            }
        }

        // Funci√≥n para generar el objeto de datos de categor√≠as
function generateCategoriesData() {
    const data = {};
    mainInfluencersData.forEach(influencer => {
        if (influencer.categories) {
            influencer.categories.forEach(category => {
                if (!data[category]) {
                    data[category] = [];
                }
                data[category].push(influencer);
            });
        }
    });
    return data;
}

// Funci√≥n para abrir el modal de categor√≠as
function openCategoriesModal() {
    categoriesData = generateCategoriesData();
    renderCategories();
    
    // Actualizar estad√≠sticas
    const totalCategoriesEl = document.getElementById('totalCategories');
    const totalInfluencersEl = document.getElementById('totalInfluencers');
    if (totalCategoriesEl) totalCategoriesEl.textContent = Object.keys(categoriesData).length;
    if (totalInfluencersEl) totalInfluencersEl.textContent = mainInfluencersData.length;

    const categoriesModal = document.getElementById('categoriesModal');
    categoriesModal.style.display = 'flex';
    setTimeout(() => {
        categoriesModal.classList.add('active');
    }, 10);
}

// Funci√≥n para cerrar el modal de categor√≠as
function closeCategoriesModal() {
    const categoriesModal = document.getElementById('categoriesModal');
    categoriesModal.classList.remove('active');
    setTimeout(() => {
        categoriesModal.style.display = 'none';
    }, 300);
}

// Funci√≥n para renderizar las categor√≠as en el modal - VERSI√ìN CON SELECCI√ìN M√öLTIPLE
// Reemplaza la funci√≥n renderCategories con esta versi√≥n actualizada
// Reemplaza la funci√≥n renderCategories con esta versi√≥n actualizada
function renderCategories() {
    const container = document.getElementById('categoriesContainer');
    if (!container) return;
    container.innerHTML = '';

    // A√±adir bot√≥n "Todos" al principio
    const allButton = document.createElement('button');
    allButton.className = 'category-header-btn all-btn';
    if (selectedCategories.size === 0 || selectedCategories.size === Object.keys(categoriesData).length) {
        allButton.classList.add('selected');
    }
    allButton.textContent = 'Todos';
    allButton.addEventListener('click', () => {
        selectAllCategories();
    });
    container.appendChild(allButton);

    // Renderizar categor√≠as existentes
    Object.keys(categoriesData).forEach(categoryName => {
        const categoryButton = document.createElement('button');
        categoryButton.className = 'category-header-btn';
        if (selectedCategories.has(categoryName)) {
            categoryButton.classList.add('selected');
        }
        categoryButton.textContent = categoryName;
        categoryButton.addEventListener('click', () => {
            toggleCategory(categoryName);
        });
        container.appendChild(categoryButton);
    });

    // Actualizar contador de seleccionados y total de influencers
    updateSelectedCount();
    updateTotalInfluencersCount();
}

// Nueva funci√≥n para contar influencers en categor√≠as seleccionadas
function updateTotalInfluencersCount() {
    const totalInfluencersEl = document.getElementById('totalInfluencers');
    if (!totalInfluencersEl) return;

    let count = 0;
    let uniqueInfluencers = new Set();

    if (selectedCategories.size === 0) {
        // Si no hay categor√≠as seleccionadas, mostrar el total
        count = mainInfluencersData.length;
    } else if (selectedCategories.size === Object.keys(categoriesData).length) {
        // Si est√°n todas las categor√≠as seleccionadas, mostrar el total
        count = mainInfluencersData.length;
    } else {
        // Contar influencers √∫nicos en las categor√≠as seleccionadas
        selectedCategories.forEach(category => {
            if (categoriesData[category]) {
                categoriesData[category].forEach(influencer => {
                    uniqueInfluencers.add(influencer.id);
                });
            }
        });
        count = uniqueInfluencers.size;
    }

    totalInfluencersEl.textContent = count;
}

// Correcci√≥n para la funci√≥n selectAllCategories
function selectAllCategories() {
    // Limpiar selecciones actuales
    selectedCategories.clear();
    
    // Seleccionar todas las categor√≠as disponibles
    Object.keys(categoriesData).forEach(categoryName => {
        selectedCategories.add(categoryName);
    });
    
    renderCategories();
}

// Correcci√≥n para la funci√≥n renderCategories
function renderCategories() {
    const container = document.getElementById('categoriesContainer');
    if (!container) return;
    container.innerHTML = '';

    // A√±adir bot√≥n "Todos" al principio
    const allButton = document.createElement('button');
    allButton.className = 'category-header-btn all-btn';
    
    // Verificar si todas las categor√≠as est√°n seleccionadas
    const allCategoriesSelected = selectedCategories.size === Object.keys(categoriesData).length;
    if (selectedCategories.size === 0 || allCategoriesSelected) {
        allButton.classList.add('selected');
    }
    
    allButton.textContent = 'Todos';
    allButton.addEventListener('click', () => {
        if (allCategoriesSelected) {
            // Si ya est√°n todas seleccionadas, deseleccionar todas
            selectedCategories.clear();
        } else {
            // Si no, seleccionar todas
            selectAllCategories();
        }
        renderCategories();
    });
    container.appendChild(allButton);

    // Renderizar categor√≠as existentes
    Object.keys(categoriesData).forEach(categoryName => {
        const categoryButton = document.createElement('button');
        categoryButton.className = 'category-header-btn';
        if (selectedCategories.has(categoryName)) {
            categoryButton.classList.add('selected');
        }
        categoryButton.textContent = categoryName;
        categoryButton.addEventListener('click', () => {
            toggleCategory(categoryName);
        });
        container.appendChild(categoryButton);
    });

    // Actualizar contador de seleccionados y total de influencers
    updateSelectedCount();
    updateTotalInfluencersCount();
}

// Correcci√≥n para la funci√≥n updateSelectedCount
function updateSelectedCount() {
    const selectedCountEl = document.getElementById('selectedCount');
    if (selectedCountEl) {
        const totalCategories = Object.keys(categoriesData).length;
        if (selectedCategories.size > 0 && selectedCategories.size < totalCategories) {
            selectedCountEl.style.display = 'block';
            selectedCountEl.textContent = `${selectedCategories.size} de ${totalCategories} categor√≠as seleccionadas`;
        } else {
            selectedCountEl.style.display = 'none';
        }
    }
}

// Correcci√≥n para la funci√≥n applyFilters
function applyFilters() {
    if (selectedCategories.size === 0 || selectedCategories.size === Object.keys(categoriesData).length) {
        mainInfluencers = [...mainInfluencersData];
    } else {
        mainInfluencers = mainInfluencersData.filter(influencer => 
            influencer.categories && influencer.categories.some(cat => selectedCategories.has(cat))
        );
    }
    
    // Actualizar UI del filtro activo
    const activeCategoryInfo = document.getElementById('activeCategoryInfo');
    const activeCategoryName = document.getElementById('activeCategoryName');
    if (activeCategoryInfo && activeCategoryName) {
        if (selectedCategories.size > 0 && selectedCategories.size < Object.keys(categoriesData).length) {
            activeCategoryInfo.style.display = 'flex';
            const categoriesList = Array.from(selectedCategories).join(', ');
            activeCategoryName.textContent = `Filtrando por: ${categoriesList}`;
        } else {
            activeCategoryInfo.style.display = 'none';
        }
    }

    renderCards();
    closeCategoriesModal();
    
    if (selectedCategories.size > 0 && selectedCategories.size < Object.keys(categoriesData).length) {
        showNotification(`Mostrando influencers de ${selectedCategories.size} categor√≠as`);
    } else {
        showNotification('Mostrando todos los influencers');
    }
}

// La funci√≥n clearAllCategories permanece igual
function clearAllCategories() {
    selectedCategories.clear();
    renderCategories();
}

// La funci√≥n clearCategoryFilter permanece igual
function clearCategoryFilter() {
    selectedCategories.clear();
    mainInfluencers = [...mainInfluencersData];
    
    // Ocultar UI del filtro activo
    const activeCategoryInfo = document.getElementById('activeCategoryInfo');
    if (activeCategoryInfo) {
        activeCategoryInfo.style.display = 'none';
    }
    
    // Limpiar b√∫squeda tambi√©n
    const searchInput = document.getElementById('searchInput');
    if (searchInput) searchInput.value = '';

    renderCards();
    showNotification('Mostrando todos los influencers');
}

// Funci√≥n para toggle de categor√≠a
function toggleCategory(categoryName) {
    if (selectedCategories.has(categoryName)) {
        selectedCategories.delete(categoryName);
    } else {
        selectedCategories.add(categoryName);
    }
    renderCategories();
}

// Funci√≥n para actualizar el contador de categor√≠as seleccionadas
function updateSelectedCount() {
    const selectedCountEl = document.getElementById('selectedCount');
    if (selectedCountEl) {
        if (selectedCategories.size > 0) {
            selectedCountEl.style.display = 'block';
            selectedCountEl.textContent = `${selectedCategories.size} categor√≠as seleccionadas`;
        } else {
            selectedCountEl.style.display = 'none';
        }
    }
}

// Funci√≥n para aplicar filtros
function applyFilters() {
    if (selectedCategories.size === 0) {
        mainInfluencers = [...mainInfluencersData];
    } else {
        mainInfluencers = mainInfluencersData.filter(influencer => 
            influencer.categories && influencer.categories.some(cat => selectedCategories.has(cat))
        );
    }
    
    // Actualizar UI del filtro activo
    const activeCategoryInfo = document.getElementById('activeCategoryInfo');
    const activeCategoryName = document.getElementById('activeCategoryName');
    if (activeCategoryInfo && activeCategoryName) {
        if (selectedCategories.size > 0) {
            activeCategoryInfo.style.display = 'flex';
            const categoriesList = Array.from(selectedCategories).join(', ');
            activeCategoryName.textContent = `Filtrando por: ${categoriesList}`;
        } else {
            activeCategoryInfo.style.display = 'none';
        }
    }

    renderCards();
    closeCategoriesModal();
    
    if (selectedCategories.size > 0) {
        showNotification(`Mostrando influencers de ${selectedCategories.size} categor√≠as`);
    } else {
        showNotification('Mostrando todos los influencers');
    }
}

// Funci√≥n para limpiar todas las selecciones
function clearAllCategories() {
    selectedCategories.clear();
    renderCategories();
}

// Funci√≥n para limpiar el filtro de categor√≠a
function clearCategoryFilter() {
    selectedCategories.clear();
    mainInfluencers = [...mainInfluencersData];
    
    // Ocultar UI del filtro activo
    const activeCategoryInfo = document.getElementById('activeCategoryInfo');
    if (activeCategoryInfo) {
        activeCategoryInfo.style.display = 'none';
    }
    
    // Limpiar b√∫squeda tambi√©n
    const searchInput = document.getElementById('searchInput');
    if (searchInput) searchInput.value = '';

    renderCards();
    showNotification('Mostrando todos los influencers');
}

        // Funci√≥n para guardar nombres personalizados en localStorage
        function saveCustomTierNames() {
            try {
                localStorage.setItem('customTierNames', JSON.stringify(customTierNames));
            } catch (e) {
                console.error('Error al guardar nombres personalizados:', e);
            }
        }

        // Funci√≥n para obtener el nombre del tier
        function getTierName(tier) {
            return customTierNames[tier] || tier.toUpperCase();
        }

        // Funci√≥n para extraer el ID del video de YouTube de una URL
        function getYouTubeId(url) {
            const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[7].length === 11) ? match[7] : null;
        }

        // Funci√≥n para validar URL de YouTube
        function isValidYouTubeUrl(url) {
            const youtubeRegex = /^(https?:\/\/)?(www\.)?(youtube\.com|youtu\.be)\/.+/;
            return youtubeRegex.test(url) && getYouTubeId(url) !== null;
        }

        // Funci√≥n para crear una tarjeta
        function createCard(influencer) {
            const cardContainer = document.createElement('div');
            cardContainer.className = 'card-container';
            cardContainer.dataset.id = influencer.id;

            const card = document.createElement('div');
            card.className = 'card';
            
            // Frente de la tarjeta
            const cardFront = document.createElement('div');
            cardFront.className = 'card-face card-front';
            
            const musicIcon = document.createElement('div');
            musicIcon.className = 'music-icon';
            musicIcon.textContent = 'üé∂';
            
            const cardText = document.createElement('div');
            cardText.className = 'card-front-text';
            cardText.textContent = '¬°Descubre!';
            
            const cardSubtext = document.createElement('div');
            cardSubtext.className = 'card-front-subtext';
            cardSubtext.textContent = 'Haz clic para ver el video';
            
            cardFront.appendChild(musicIcon);
            cardFront.appendChild(cardText);
            cardFront.appendChild(cardSubtext);
            
            // Reverso de la tarjeta
            const cardBack = document.createElement('div');
            cardBack.className = 'card-face card-back';
            
            const influencerHeader = document.createElement('div');
            influencerHeader.className = 'influencer-header';
            
            const influencerName = document.createElement('div');
            influencerName.className = 'influencer-name';
            influencerName.textContent = influencer.name;
            
            influencerHeader.appendChild(influencerName);
            
            const videoContainer = document.createElement('div');
            videoContainer.className = 'video-container';
            
            const videoThumbnail = document.createElement('img');
            videoThumbnail.className = 'video-thumbnail';
            videoThumbnail.src = `https://img.youtube.com/vi/${influencer.videoId}/maxresdefault.jpg`;
            videoThumbnail.alt = influencer.name;
            videoThumbnail.dataset.videoId = influencer.videoId;
            videoThumbnail.onerror = function() {
                this.src = `https://img.youtube.com/vi/${this.dataset.videoId}/hqdefault.jpg`;
            };
            
            const playButton = document.createElement('div');
            playButton.className = 'play-button';
            
            videoContainer.appendChild(videoThumbnail);
            videoContainer.appendChild(playButton);
            
            cardBack.appendChild(influencerHeader);
            cardBack.appendChild(videoContainer);
            
            card.appendChild(cardFront);
            card.appendChild(cardBack);
            
            cardContainer.appendChild(card);
            
            // Event listener principal para la tarjeta
            card.addEventListener('click', function() {
                handleCardClick(influencer, card);
            });
            
            // Event listeners para el video
            playButton.addEventListener('click', function(e) {
                e.stopPropagation();
                openModal(influencer);
            });
            
            videoThumbnail.addEventListener('click', function(e) {
                e.stopPropagation();
                openModal(influencer);
            });
            
            return cardContainer;
        }

        // Funci√≥n para manejar el clic en una tarjeta
            function handleCardClick(influencer, card) {
                if (card.classList.contains('flipped')) {
                    openModal(influencer);
                    return;
                }
                
                card.classList.add('animating');
                
                setTimeout(() => {
                    card.classList.remove('animating');
                    card.classList.add('flipped');
                    revealedCards.add(influencer.id);
                    card.classList.add('revealed');
                    
                    // A√±adir a la lista de no clasificados si no tiene tier
                    if (!influencer.tier) {
                        tierlistData.unclassified.push(influencer);
                    }

                    // GUARDAR: Guardar el estado de las tarjetas reveladas
                    saveRevealedCardsToLocalStorage();
                    // GUARDAR: Guardar la tierlist (por si se a√±ade a sin clasificar)
                    saveTierlistDataToLocalStorage();

                    openModal(influencer);
                }, 400);
            }

        // Funci√≥n para a√±adir al tierlist
        function addToTierlist(influencer) {
    if (!influencer.tier) return;
    
    const tierContainer = document.getElementById(`tier-${influencer.tier}`);
    if (!tierContainer) return;
    
    // Verificar si ya existe en el tier
    const existingItem = tierContainer.querySelector(`[data-influencer-id="${influencer.id}"]`);
    if (existingItem) {
        existingItem.remove(); // Eliminar el existente para evitar duplicados
    }
    
    // Crear elemento del tierlist
    const tierItem = createTierItem(influencer);
    
    // A√±adir al tierlist
    tierContainer.appendChild(tierItem);
    
    // A√±adir a los datos (evitando duplicados)
    if (!tierlistData[influencer.tier]) {
        tierlistData[influencer.tier] = [];
    }
    
    // Eliminar si ya existe
    tierlistData[influencer.tier] = tierlistData[influencer.tier].filter(item => item.id !== influencer.id);
    
    // A√±adir el nuevo
    tierlistData[influencer.tier].push(influencer);
    
    // Mostrar notificaci√≥n
    const oldTier = tierlistData[influencer.tier].find(item => item.id === influencer.id)?.tier;
    if (oldTier && oldTier !== influencer.tier) {
        showNotification(`${influencer.name} movido de tier ${getTierName(oldTier)} a tier ${getTierName(influencer.tier)}`);
    } else if (!oldTier) {
        showNotification(`${influencer.name} a√±adido a tier ${getTierName(influencer.tier)}`);
    }
}


    // Funci√≥n para crear un elemento del tierlist
        function createTierItem(influencer) {
        const tierItem = document.createElement('div');
        tierItem.className = 'tier-item';
        tierItem.dataset.influencerId = influencer.id;
        tierItem.draggable = true;
        
        const thumbnail = document.createElement('img');
        thumbnail.className = 'tier-item-thumbnail';
        thumbnail.src = `https://img.youtube.com/vi/${influencer.videoId}/mqdefault.jpg`;
        thumbnail.alt = influencer.name;
        
        const name = document.createElement('div');
        name.className = 'tier-item-name';
        name.textContent = influencer.name;
        
        const removeBtn = document.createElement('div');
        removeBtn.className = 'tier-item-remove';
        removeBtn.textContent = '√ó';
        removeBtn.addEventListener('click', function(e) {
            e.stopPropagation(); // ¬°Importante! Evita que se abra el modal al borrar
            removeFromTierlist(influencer.id);
        });
        
        tierItem.appendChild(thumbnail);
        tierItem.appendChild(name);
        tierItem.appendChild(removeBtn);
        
        // --- NUEVO: A√±adir listener para abrir el video al hacer clic ---
        tierItem.addEventListener('click', function(e) {
            // Si el clic fue en el bot√≥n de eliminar, no hacer nada m√°s
            if (e.target === removeBtn) {
                return;
            }
            // Abrir el modal del video con los datos del influencer
            openModal(influencer);
        });
        // --- FIN DEL NUEVO C√ìDIGO ---
        
        // Event listeners para drag and drop (ya exist√≠an)
        tierItem.addEventListener('dragstart', handleDragStart);
        tierItem.addEventListener('dragend', handleDragEnd);
        
        return tierItem;
    }
    

        // Funci√≥n para eliminar del tierlist
        function removeFromTierlist(influencerId) {
    const influencer = findInfluencerById(influencerId);
    if (!influencer) return;
    
    // Encontrar el tier actual del influencer (por si el estado es inconsistente)
    let currentTier = influencer.tier;
    if (!currentTier) {
        // Buscar en qu√© lista de datos est√° el influencer
        const allTiers = ['s', 'a', 'b', 'c', 'd', 'f', 'unclassified'];
        for (const tier of allTiers) {
            if (tierlistData[tier] && tierlistData[tier].some(item => item.id === influencerId)) {
                currentTier = tier;
                break;
            }
        }
    }
    
    // Si lo encontramos en alg√∫n tier, proceder a eliminarlo
    if (currentTier) {
        // Eliminar del DOM
        const tierContainer = document.getElementById(`tier-${currentTier}`);
        if (tierContainer) {
            const tierItem = tierContainer.querySelector(`[data-influencer-id="${influencerId}"]`);
            if (tierItem) {
                tierItem.remove();
            }
        }
        
        // Eliminar de los datos
        if (tierlistData[currentTier]) {
            tierlistData[currentTier] = tierlistData[currentTier].filter(item => item.id !== influencerId);
        }
        
        // Resetear el tier del influencer
        influencer.tier = null;
        
        // A√±adir a "Sin Clasificar" solo si no est√° ya all√≠ (para evitar duplicados)
        if (!tierlistData.unclassified.some(item => item.id === influencer.id)) {
            tierlistData.unclassified.push(influencer);
        }
        
        // Re-renderizar "Sin Clasificar" para asegurar que la UI est√© sincronizada
        renderUnclassifiedTier();
        
        // GUARDAR: Guardar la tierlist despu√©s de eliminar
        saveTierlistDataToLocalStorage();

        // Actualizar estad√≠sticas
        updateTierlistStats();
        
        // Mostrar notificaci√≥n
        showNotification(`${influencer.name} movido a Sin Clasificar`);
    }
}


        // Funci√≥n para encontrar un influencer por ID
        function findInfluencerById(id) {
            return [...mainInfluencersData, ...fansInfluencersData].find(inf => inf.id === id);
        }

        // Funciones de drag and drop
        function handleDragStart(e) {
            draggedElement = this;
            draggedInfluencer = findInfluencerById(this.dataset.influencerId);
            this.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
        }

        function handleDragEnd(e) {
            this.classList.remove('dragging');
            
            // Eliminar clases drag-over de todos los tiers
            document.querySelectorAll('.tier-row').forEach(row => {
                row.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            if (e.preventDefault) {
                e.preventDefault();
            }
            e.dataTransfer.dropEffect = 'move';
            
            const tierRow = this.closest('.tier-row');
            if (tierRow) {
                tierRow.classList.add('drag-over');
            }
            
            return false;
        }

        function handleDragLeave(e) {
            const tierRow = this.closest('.tier-row');
            if (tierRow) {
                tierRow.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
    if (e.stopPropagation) {
        e.stopPropagation();
    }
    e.preventDefault();
    
    const newTier = this.closest('.tier-row').dataset.tier;
    
    if (draggedInfluencer && draggedElement && newTier !== draggedInfluencer.tier) {
        // --- CORRECCI√ìN CLAVE: Obtener el tier de origen desde el DOM ---
        const oldTierRow = draggedElement.closest('.tier-row');
        const oldTier = oldTierRow ? oldTierRow.dataset.tier : null;

        // Mover el elemento en el DOM
        this.appendChild(draggedElement);
        
        // Actualizar el tier del influencer en los datos maestros
        draggedInfluencer.tier = newTier;
        
        // Eliminar de los datos del tier anterior
        if (oldTier && tierlistData[oldTier]) {
            tierlistData[oldTier] = tierlistData[oldTier].filter(item => item.id !== draggedInfluencer.id);
        }

        // A√±adir a los datos del nuevo tier
        if (!tierlistData[newTier]) {
            tierlistData[newTier] = [];
        }
        
        // Evitar duplicados en el nuevo tier
        tierlistData[newTier] = tierlistData[newTier].filter(item => item.id !== draggedInfluencer.id);
        tierlistData[newTier].push(draggedInfluencer);

        // Actualizar estad√≠sticas
        updateTierlistStats();
        
        // Guardar el estado correcto en localStorage
        saveTierlistDataToLocalStorage();
        
        // Mostrar notificaci√≥n
        showNotification(`${draggedInfluencer.name} movido a tier ${getTierName(newTier)}`);
    }
    
    // Limpiar clases visuales
    document.querySelectorAll('.tier-row').forEach(row => {
        row.classList.remove('drag-over');
    });
    
    return false;
}

        // Funci√≥n para actualizar estad√≠sticas del tierlist
        function updateTierlistStats() {
            const totalRevealed = revealedCards.size;
            const totalSongs = mainInfluencersData.length + fansInfluencersData.length;
            
            const totalRevealedEl = document.getElementById('totalRevealed');
            const totalSongsEl = document.getElementById('totalSongs');
            
            if (totalRevealedEl) totalRevealedEl.textContent = totalRevealed;
            if (totalSongsEl) totalSongsEl.textContent = totalSongs;
        }

        // Funci√≥n para actualizar nombres de tiers en la UI
        function updateTierNames() {
            const tiers = ['s', 'a', 'b', 'c', 'd', 'f'];
            
            // Actualizar etiquetas en el modal de video
            tiers.forEach(tier => {
                const option = document.querySelector(`.tier-option[data-tier="${tier}"]`);
                if (option) {
                    option.textContent = getTierName(tier);
                }
            });
            
            // Actualizar etiquetas en la tierlist
            tiers.forEach(tier => {
                const label = document.querySelector(`.tier-row[data-tier="${tier}"] .tier-label`);
                if (label) {
                    label.textContent = getTierName(tier);
                }
            });
        }
        

        // NUEVA FUNCI√ìN: Renderizar la categor√≠a "Sin Clasificar"
        function renderUnclassifiedTier() {
            const unclassifiedContainer = document.getElementById('tier-unclassified');
            if (!unclassifiedContainer) return;

            unclassifiedContainer.innerHTML = '';
            tierlistData.unclassified.forEach(influencer => {
                const tierItem = createTierItem(influencer);
                unclassifiedContainer.appendChild(tierItem);
            });
        }

        // Funci√≥n para abrir el modal
        // FUNCI√ìN CORREGIDA: openModal
function openModal(influencer) {
    if (isModalOpen) return;
    
    currentInfluencer = influencer;
    isModalOpen = true;
    
    const modalTitle = document.getElementById('modalTitle');
    const modalVideo = document.getElementById('modalVideo');
    const tierSelectionStatus = document.getElementById('tierSelectionStatus');
    const tierOptions = document.querySelectorAll('.tier-option');
    
    modalTitle.textContent = influencer.name;
    modalVideo.src = `https://www.youtube.com/embed/${influencer.videoId}?rel=0&showinfo=0&modestbranding=1&autoplay=1`;
    
    // --- PASO 1: Resetear SIEMPRE la UI a su estado por defecto ---
    tierOptions.forEach(option => {
        option.classList.remove('selected', 'disabled');
        // Actualizar texto con nombres personalizados por si acaso
        const tier = option.dataset.tier;
        option.textContent = getTierName(tier);
    });
    
    // Resetear el mensaje de estado a su valor inicial
    tierSelectionStatus.textContent = 'Haz clic en un tier para clasificar esta canci√≥n';
    tierSelectionStatus.classList.remove('success');
    
    // --- PASO 2: Aplicar el estado del influencer actual (si lo tiene) ---
    if (influencer.tier) {
        const existingTierOption = document.querySelector(`.tier-option[data-tier="${influencer.tier}"]`);
        if (existingTierOption) {
            existingTierOption.classList.add('selected');
            tierSelectionStatus.textContent = `Esta canci√≥n est√° en tier ${getTierName(influencer.tier)}. Haz clic en otro tier para cambiarla.`;
            tierSelectionStatus.classList.add('success');
        }
    }
    
    // L√≥gica para mostrar el modal sobre la tierlist (si es necesario)
    const videoModal = document.getElementById('videoModal');
    if (isTierlistModalOpen) {
        videoModal.classList.add('on-top-of-tierlist');
    } else {
        videoModal.classList.remove('on-top-of-tierlist');
    }
    
    // Mostrar modal con animaci√≥n
    videoModal.style.display = 'flex';
    setTimeout(() => {
        videoModal.classList.add('active');
    }, 10);
}

        // Funci√≥n para cerrar el modal
function closeModalFunc() {
    // Limpiar el video inmediatamente para detener la reproducci√≥n
    const modalVideo = document.getElementById('modalVideo');
    modalVideo.src = '';
    
    const videoModal = document.getElementById('videoModal');
    videoModal.classList.remove('active');
    videoModal.classList.remove('on-top-of-tierlist'); // <-- IMPORTANTE: Quitar la clase al cerrar
    isModalOpen = false;
    currentInfluencer = null;
    
    setTimeout(() => {
        videoModal.style.display = 'none';
    }, 300);
}

        // Funci√≥n para manejar la selecci√≥n de tier
        function handleTierSelection(tier) {
    if (!currentInfluencer) return;
    
    const oldTier = currentInfluencer.tier;
    
    // Si es el mismo tier, no hacer nada
    if (oldTier === tier) {
        const tierSelectionStatus = document.getElementById('tierSelectionStatus');
        tierSelectionStatus.textContent = `Esta canci√≥n ya est√° en tier ${getTierName(tier)}`;
        tierSelectionStatus.classList.add('success');
        return;
    }
    
    // Si ya ten√≠a un tier, eliminarlo del tier anterior
    if (oldTier) {
        // Eliminar del tier anterior en la UI
        const oldTierContainer = document.getElementById(`tier-${oldTier}`);
        if (oldTierContainer) {
            const tierItem = oldTierContainer.querySelector(`[data-influencer-id="${currentInfluencer.id}"]`);
            if (tierItem) {
                tierItem.remove();
            }
        }
        
        // Eliminar de los datos
        if (tierlistData[oldTier]) {
            tierlistData[oldTier] = tierlistData[oldTier].filter(item => item.id !== currentInfluencer.id);
        }
    } else {
        // Si no ten√≠a tier, eliminar de sin clasificar
        tierlistData.unclassified = tierlistData.unclassified.filter(item => item.id !== currentInfluencer.id);
        renderUnclassifiedTier();
    }
    
    // Asignar el nuevo tier
    currentInfluencer.tier = tier;
    
    // A√±adir al nuevo tier
    addToTierlist(currentInfluencer);
    
    // Actualizar UI del modal
    const tierSelectionStatus = document.getElementById('tierSelectionStatus');
    if (oldTier) {
        tierSelectionStatus.textContent = `Cambiado de tier ${getTierName(oldTier)} a tier ${getTierName(tier)}!`;
    } else {
        tierSelectionStatus.textContent = `¬°Clasificado en tier ${getTierName(tier)}!`;
    }
    tierSelectionStatus.classList.add('success');
    
    // Marcar el nuevo tier como seleccionado
    const tierOptions = document.querySelectorAll('.tier-option');
    tierOptions.forEach(option => {
        option.classList.remove('selected');
        if (option.dataset.tier === tier) {
            option.classList.add('selected');
        }
    });

        // GUARDAR: Guardar la tierlist despu√©s de cada cambio
    saveTierlistDataToLocalStorage();
    
    // Actualizar estad√≠sticas
    updateTierlistStats();
}


        // Funci√≥n para abrir el modal de a√±adir influencer
        function openAddModal() {
            const addModal = document.getElementById('addModal');
            addModal.style.display = 'flex';
            setTimeout(() => {
                addModal.classList.add('active');
            }, 10);
        }

        // Funci√≥n para cerrar el modal de a√±adir influencer
        function closeAddModal() {
            const addModal = document.getElementById('addModal');
            addModal.classList.remove('active');
            
            setTimeout(() => {
                addModal.style.display = 'none';
                // Limpiar formulario
                const addInfluencerForm = document.getElementById('addInfluencerForm');
                if (addInfluencerForm) addInfluencerForm.reset();
                
                // Ocultar mensajes de error y √©xito
                const nameError = document.getElementById('nameError');
                const urlError = document.getElementById('urlError');
                const successMessage = document.getElementById('successMessage');
                
                if (nameError) nameError.style.display = 'none';
                if (urlError) urlError.style.display = 'none';
                if (successMessage) successMessage.style.display = 'none';
            }, 300);
        }

        // Funci√≥n para abrir el modal de tierlist
        function openTierlistModal() {
            // Actualizar estad√≠sticas
            updateTierlistStats();
            
            // Actualizar nombres de tiers
            updateTierNames();
            
            // Renderizar todas las categor√≠as
            renderAllTiers();

            // Configurar drag and drop para los tiers
            setupTierlistDragAndDrop();
            
                isTierlistModalOpen = true; // <-- A√ëADE ESTA L√çNEA

            // Mostrar modal con animaci√≥n
            const tierlistModal = document.getElementById('tierlistModal');
            tierlistModal.style.display = 'flex';
            setTimeout(() => {
                tierlistModal.classList.add('active');
            }, 10);
        }

        // NUEVA FUNCI√ìN: Renderizar todos los tiers a la vez
        function renderAllTiers() {
            const tiers = ['s', 'a', 'b', 'c', 'd', 'f'];
            
            // Renderizar la lista de sin clasificar primero
            renderUnclassifiedTier();

            // Renderizar el resto de los tiers
            tiers.forEach(tier => {
                const tierContainer = document.getElementById(`tier-${tier}`);
                if (!tierContainer) return;
                tierContainer.innerHTML = '';

                if (tierlistData[tier]) {
                    tierlistData[tier].forEach(influencer => {
                        const tierItem = createTierItem(influencer);
                        tierContainer.appendChild(tierItem);
                    });
                }
            });
        }

        // Funci√≥n para abrir el modal de edici√≥n de tiers
        function openEditTiersModal() {
            // Cargar nombres actuales en los inputs
            const tiers = ['s', 'a', 'b', 'c', 'd', 'f'];
            tiers.forEach(tier => {
                const input = document.getElementById(`tier-name-${tier}`);
                if (input) {
                    input.value = customTierNames[tier];
                }
            });
            
            // Mostrar modal con animaci√≥n
            const editTiersModal = document.getElementById('editTiersModal');
            editTiersModal.style.display = 'flex';
            setTimeout(() => {
                editTiersModal.classList.add('active');
            }, 10);
        }

        // Funci√≥n para cerrar el modal de edici√≥n de tiers
        function closeEditTiersModal() {
            const editTiersModal = document.getElementById('editTiersModal');
            editTiersModal.classList.remove('active');
            
            setTimeout(() => {
                editTiersModal.style.display = 'none';
            }, 300);
        }

        // Funci√≥n para guardar los nombres personalizados
        function saveTierNames() {
            const tiers = ['s', 'a', 'b', 'c', 'd', 'f'];
            let hasChanges = false;
            
            tiers.forEach(tier => {
                const input = document.getElementById(`tier-name-${tier}`);
                if (input) {
                    const newName = input.value.trim();
                    if (newName && newName !== customTierNames[tier]) {
                        customTierNames[tier] = newName;
                        hasChanges = true;
                    }
                }
            });
            
            if (hasChanges) {
                saveCustomTierNames();
                updateTierNames();
                showNotification('Nombres de tiers actualizados correctamente');
            }
            
            closeEditTiersModal();
        }

        // Funci√≥n para restablecer nombres de tiers
        function resetTierNames() {
            customTierNames = {
                s: 'S',
                a: 'A',
                b: 'B',
                c: 'C',
                d: 'D',
                f: 'F'
            };
            
            saveCustomTierNames();
            updateTierNames();
            
            // Actualizar inputs
            const tiers = ['s', 'a', 'b', 'c', 'd', 'f'];
            tiers.forEach(tier => {
                const input = document.getElementById(`tier-name-${tier}`);
                if (input) {
                    input.value = customTierNames[tier];
                }
            });
            
            showNotification('Nombres de tiers restablecidos');
        }

        // Funci√≥n para cerrar el modal de tierlist
        function closeTierlistModal() {
            const tierlistModal = document.getElementById('tierlistModal');
            tierlistModal.classList.remove('active');
            isTierlistModalOpen = false; // <-- A√ëADE ESTA L√çNEA

            
            setTimeout(() => {
                tierlistModal.style.display = 'none';
            },300);
        }

        // Funci√≥n para a√±adir un nuevo influencer
        function addInfluencer(name, url) {
    const videoId = getYouTubeId(url);
    
    const newInfluencer = {
        id: nextId.toString(),
        name: name,
        youtubeUrl: url,
        videoId: videoId,
        tier: null,
        categories: []
    };
    
    mainInfluencers.push(newInfluencer);
    mainInfluencersData.push(newInfluencer);
    nextId++;
    
    // Guardar ambos: la lista de influencers Y el siguiente ID
    saveInfluencersDataToLocalStorage();
    saveNextIdToLocalStorage(); // <-- A√ëADE ESTA L√çNEA
    
    // Mostrar mensaje de √©xito
    const successMessage = document.getElementById('successMessage');
    if (successMessage) successMessage.style.display = 'block';
    
    renderCards();
    
    setTimeout(() => {
        closeAddModal();
    }, 750);
}

        // Reemplaza la funci√≥n existente con esta versi√≥n actualizada
        function renderCards() {
    const cardsGrid = document.getElementById('cardsGrid');
    if (!cardsGrid) return;
    
    cardsGrid.innerHTML = '';
    
    // --- CORRECCI√ìN CLAVE: Usar la lista actual en lugar de la original ---
    let influencersToRender = [...mainInfluencers];

    // Aplicar filtro de categor√≠as si hay categor√≠as seleccionadas
    if (selectedCategories.size > 0) {
        influencersToRender = influencersToRender.filter(influencer => 
            influencer.categories && influencer.categories.some(cat => selectedCategories.has(cat))
        );
    }
    
    // Aplicar filtro de b√∫squeda si hay texto
    const searchInput = document.getElementById('searchInput');
    if (searchInput && searchInput.value.trim() !== '') {
        const searchTerm = searchInput.value.toLowerCase();
        influencersToRender = influencersToRender.filter(influencer => 
            influencer.name.toLowerCase().includes(searchTerm)
        );
    }

    if (influencersToRender.length === 0) {
        const noResults = document.getElementById('noResults');
        if (noResults) noResults.style.display = 'block';
        return;
    }
    
    const noResults = document.getElementById('noResults');
    if (noResults) noResults.style.display = 'none';
    
    influencersToRender.forEach(influencer => {
        const card = createCard(influencer);
        cardsGrid.appendChild(card);
        
        if (revealedCards.has(influencer.id)) {
            const cardElement = card.querySelector('.card');
            if (cardElement) {
                cardElement.classList.add('flipped');
                cardElement.classList.add('revealed');
            }
        }
    });
}

        // Funci√≥n para renderizar las tarjetas de fans
        function renderFansCards() {
            const fansCardsGrid = document.getElementById('fansCardsGrid');
            if (!fansCardsGrid) return;
            
            fansCardsGrid.innerHTML = '';
            
            fansInfluencers.forEach(influencer => {
                const card = createCard(influencer);
                fansCardsGrid.appendChild(card);
                
                // Si la tarjeta ya fue revelada, marcarla
                if (revealedCards.has(influencer.id)) {
                    const cardElement = card.querySelector('.card');
                    if (cardElement) {
                        cardElement.classList.add('flipped');
                        cardElement.classList.add('revealed');
                    }
                }
            });
        }

        // Funci√≥n para buscar influencers
        function searchInfluencers() {
            const searchInput = document.getElementById('searchInput');
            if (!searchInput) return;
            
            const searchTerm = searchInput.value.toLowerCase();
            
            if (searchTerm === '') {
                mainInfluencers = [...mainInfluencersData];
            } else {
                mainInfluencers = mainInfluencersData.filter(influencer => 
                    influencer.name.toLowerCase().includes(searchTerm)
                );
            }
            
            renderCards();
        }

        // Funci√≥n para reordenar las tarjetas
        function shuffleCards() {
            mainInfluencers = [...mainInfluencers].sort(() => Math.random() - 0.5);
            renderCards();
            
            if (fansToggleActive) {
                fansInfluencers = [...fansInfluencers].sort(() => Math.random() - 0.5);
                renderFansCards();
            }
        }

        // Funci√≥n para toggle de fans
        function toggleFans() {
            fansToggleActive = !fansToggleActive;
            
            const fansToggle = document.getElementById('fansToggle');
            const fansSection = document.getElementById('fansSection');
            
            if (fansToggle && fansSection) {
                if (fansToggleActive) {
                    fansToggle.classList.add('active');
                    fansSection.classList.add('active');
                    renderFansCards();
                } else {
                    fansToggle.classList.remove('active');
                    fansSection.classList.remove('active');
                }
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('URL copiada al portapapeles');
            }).catch(err => {
                console.error('Error al copiar al portapapeles:', err);
                showNotification('Error al copiar la URL');
            });
        }

        function showNotification(message) {
            const notification = document.getElementById('notification');
            if (notification) {
                notification.textContent = message;
                notification.classList.add('show');
                
                // La notificaci√≥n desaparecer√° autom√°ticamente despu√©s de 3 segundos
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000); 
            }
        }

        // Variables para el tierlist
        let tierlistData = {
            unclassified: [], // NUEVA CATEGOR√çA
            s: [],
            a: [],
            b: [],
            c: [],
            d: [],
            f: []
        };

        // Configurar event listeners - Versi√≥n simplificada y robusta
        function setupEventListeners() {
            console.log('Configurando event listeners...');
            
            // Botones principales
            const shuffleBtn = document.getElementById('shuffleBtn');
            if (shuffleBtn) {
                shuffleBtn.addEventListener('click', shuffleCards);
                console.log('Listener a√±adido a shuffleBtn');
            }
            
            // Listener para el bot√≥n de categor√≠as
            const categoriesBtn = document.getElementById('categoriesBtn');
            if (categoriesBtn) {
                categoriesBtn.addEventListener('click', openCategoriesModal);
            }

            // Listener para cerrar el modal de categor√≠as
            const closeCategoriesModalBtn = document.getElementById('closeCategoriesModal');
            if (closeCategoriesModalBtn) {
                closeCategoriesModalBtn.addEventListener('click', closeCategoriesModal);
            }

            // Listener para el bot√≥n de limpiar filtro
            const clearFilterBtn = document.getElementById('clearFilterBtn');
            if (clearFilterBtn) {
                clearFilterBtn.addEventListener('click', clearCategoryFilter);
            }

            // Listener para aplicar filtros
            const applyFiltersBtn = document.getElementById('applyFiltersBtn');
            if (applyFiltersBtn) {
                applyFiltersBtn.addEventListener('click', applyFilters);
            }

            // Listener para limpiar todo
            const clearAllBtn = document.getElementById('clearAllBtn');
            if (clearAllBtn) {
                clearAllBtn.addEventListener('click', clearAllCategories);
            }

            // Listener para cerrar modal haciendo clic fuera
            const categoriesModalEl = document.getElementById('categoriesModal');
            if (categoriesModalEl) {
                categoriesModalEl.addEventListener('click', function(e) {
                    if (e.target === categoriesModalEl) {
                        closeCategoriesModal();
                    }
                });
            }
            
            const addBtn = document.getElementById('addBtn');
            if (addBtn) {
                addBtn.addEventListener('click', openAddModal);
                console.log('Listener a√±adido a addBtn');
            }
            
            const tierlistBtn = document.getElementById('tierlistBtn');
            if (tierlistBtn) {
                tierlistBtn.addEventListener('click', openTierlistModal);
                console.log('Listener a√±adido a tierlistBtn');
            }
            
            // Cerrar modales
            const closeModal = document.getElementById('closeModal');
            if (closeModal) {
                closeModal.addEventListener('click', closeModalFunc);
            }
            
            const cancelAddBtn = document.getElementById('cancelAddBtn');
            if (cancelAddBtn) {
                cancelAddBtn.addEventListener('click', closeAddModal);
            }
            
            const closeTierlistModalBtn = document.getElementById('closeTierlistModal');
            if (closeTierlistModalBtn) {
                closeTierlistModalBtn.addEventListener('click', closeTierlistModal);
            }
            
            // B√∫squeda
            const searchInput = document.getElementById('searchInput');
            if (searchInput) {
                searchInput.addEventListener('input', searchInfluencers);
            }
            
            // Toggle de fans
            const fansToggle = document.getElementById('fansToggle');
            if (fansToggle) {
                fansToggle.addEventListener('click', toggleFans);
            }
            
            // Formulario de a√±adir influencer
            const addInfluencerForm = document.getElementById('addInfluencerForm');
            if (addInfluencerForm) {
                addInfluencerForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Resetear mensajes de error
                    const nameError = document.getElementById('nameError');
                    const urlError = document.getElementById('urlError');
                    
                    if (nameError) nameError.style.display = 'none';
                    if (urlError) urlError.style.display = 'none';
                    
                    const influencerNameInput = document.getElementById('influencerName');
                    const youtubeUrlInput = document.getElementById('youtubeUrl');
                    
                    if (!influencerNameInput || !youtubeUrlInput) return;
                    
                    const name = influencerNameInput.value.trim();
                    const url = youtubeUrlInput.value.trim();
                    
                    let hasError = false;
                    
                    // Validar nombre
                    if (name.length < 2) {
                        if (nameError) nameError.style.display = 'block';
                        hasError = true;
                    }
                    
                    // Validar URL
                    if (!isValidYouTubeUrl(url)) {
                        if (urlError) urlError.style.display = 'block';
                        hasError = true;
                    }
                    
                    if (!hasError) {
                        addInfluencer(name, url);
                    }
                });
            }
            
            // Event listeners para los tiers en el modal de video
            const tierOptions = document.querySelectorAll('.tier-option');
            tierOptions.forEach(option => {
                option.addEventListener('click', function() {
                    const tier = this.dataset.tier;
                    handleTierSelection(tier);
                });
            });
            
            // Event listeners para edici√≥n de tiers
            const editTiersBtn = document.getElementById('editTiersBtn');
            if (editTiersBtn) {
                editTiersBtn.addEventListener('click', openEditTiersModal);
            }
            
            const saveTiersBtn = document.getElementById('saveTiersBtn');
            if (saveTiersBtn) {
                saveTiersBtn.addEventListener('click', saveTierNames);
            }
            
            const resetTiersBtn = document.getElementById('resetTiersBtn');
            if (resetTiersBtn) {
                resetTiersBtn.addEventListener('click', resetTierNames);
            }
            
            const closeEditTiersModalBtn = document.getElementById('closeEditTiersModal');
            if (closeEditTiersModalBtn) {
                closeEditTiersModalBtn.addEventListener('click', closeEditTiersModal);
            }
            
            // Cerrar modales al hacer clic fuera
            const videoModal = document.getElementById('videoModal');
            if (videoModal) {
                videoModal.addEventListener('click', function(e) {
                    if (e.target === videoModal) {
                        closeModalFunc();
                    }
                });
            }
            
            const addModal = document.getElementById('addModal');
            if (addModal) {
                addModal.addEventListener('click', function(e) {
                    if (e.target === addModal) {
                        closeAddModal();
                    }
                });
            }
            
            const tierlistModal = document.getElementById('tierlistModal');
            if (tierlistModal) {
                tierlistModal.addEventListener('click', function(e) {
                    if (e.target === tierlistModal) {
                        closeTierlistModal();
                    }
                });
            }
            
            const editTiersModalEl = document.getElementById('editTiersModal');
            if (editTiersModalEl) {
                editTiersModalEl.addEventListener('click', function(e) {
                    if (e.target === editTiersModalEl) {
                        closeEditTiersModal();
                    }
                });
            }
            
            // Prevenir que el modal se cierre al hacer clic en el video
            const modalVideo = document.getElementById('modalVideo');
            if (modalVideo) {
                modalVideo.addEventListener('click', function(e) {
                    e.stopPropagation();
                });
            }
            
            console.log('Todos los event listeners configurados');
        }

        // Funci√≥n para configurar drag and drop en la tierlist
        function setupTierlistDragAndDrop() {
            const tierItems = document.querySelectorAll('.tier-items');
            
            tierItems.forEach(tier => {
                tier.addEventListener('dragover', handleDragOver);
                tier.addEventListener('drop', handleDrop);
                tier.addEventListener('dragleave', handleDragLeave);
            });
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
    console.log('Inicializando aplicaci√≥n...');
    
    // 1. Cargar nombres personalizados
    loadCustomTierNames();
    
    // 2. CARGAR DATOS DESDE LOCALSTORAGE (en orden)
    loadInfluencersDataFromLocalStorage(); // Carga la lista maestra
    loadNextIdFromLocalStorage();           // Carga el siguiente ID
    
    // --- PASO CLAVE: Sincronizar la copia de trabajo con la lista maestra cargada ---
    mainInfluencers = [...mainInfluencersData];
    
    // 3. Cargar el resto de los datos de estado
    loadRevealedCardsFromLocalStorage();
    loadTierlistDataFromLocalStorage();
    syncInfluencerTiersFromLoadedData();
    
    // 4. Cargar el Easter Egg
    loadEasterEgg();
    
    // 5. Configurar event listeners
    setupEventListeners();
    
    // 6. Renderizar la UI con los datos cargados y sincronizados
    renderCards();
    
    // Actualizar contador de fans
    const fansCount = document.getElementById('fansCount');
    if (fansCount) {
        fansCount.textContent = `${fansInfluencersData.length} canciones disponibles`;
    }
    
    console.log('Aplicaci√≥n inicializada correctamente con datos guardados.');
});
    </script>

        <!-- Notificaci√≥n -->
        <div class="notification" id="notification">	

</body>
</html>
